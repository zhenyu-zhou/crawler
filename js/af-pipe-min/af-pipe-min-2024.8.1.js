YUI.add("stencil-fx",function(e,t){"use strict";function r(e){this.constructor.superclass.constructor.call(this,e)}var n;n=function(){},n.prototype={getActiveClass:function(){return this.constructor.NS+"-active"},transition:function(t,n){t=e.Stencil.getNodeList(t),t.each(function(t){t.addClass(this.getActiveClass()).publish("fx:start",{emitFacade:!0}),t.fire("fx:start",{fx:this.constructor.NS,fxTarget:t}),Stencil.css.transitioned(t,e.bind(function(e){this.transitionDone(e)},this)),n(t)},this)},transitionDone:function(t){var n=t.get("id");t.removeClass(this.getActiveClass()).publish("fx:done",{emitFacade:!0}),t.fire("fx:done",{fx:this.constructor.NS,fxTarget:t}),e.publish("fx:done",{emitFacade:!0}),e.fire("fx:done",{fx:this.constructor.NS,fxTarget:t})}},e.Stencil.BaseFx=n,e.extend(r,e.Stencil.BasePlugin,{execute:function(t,n){var r,i,s,o=[];n=n||{},r=n.fx;if(!r)return this;r=r.split(" ");for(i=0,s=r.length;i<s;i+=1)o.push("stencil-fx-"+r[i]);e.use(o,function(e){var i,s,o,u,a;for(u=0,a=r.length;u<a;u+=1){s=r[u],o=e.Stencil.Hosts.Fx[s];if(o){t=t.filter(":not(."+s+"-active)");if(t.size()===0)return this;for(i in n)n.hasOwnProperty(i)&&i!=="fx"&&o[i](t,n[i])}}})}},{NS:"StencilFx"}),e.Stencil.registerPlugin(r,"Fx"),e.Stencil.Hosts.Fx=e.augment({},e.Plugin.Host,!1,null)},"@VERSION@",{requires:["stencil-base","yui-base","dom-base","node-base","pluginhost","event-custom","selector-css3"]});
YUI.add("stencil-fx-collapse",function(e){"use strict";var t="Collapse-opened",n="Collapse",r="FastTrans",i="scrollHeight",s="height",o="px",u="offsetWidth",a="offsetHeight",f="0px",l;l=function(e){l.superclass.constructor.call(this,e),this.host=e.host},e.extend(l,e.Stencil.BaseFx),l.NS="collapse",l.prototype.show=function(n){return e.Stencil.getNodeList(n).each(function(e){e.get(a)<e.get(i)&&this.transition(e,function(e){var n=e.get(i)+o;e.get(a)===0&&e.setStyle(s,f).get(u),e.addClass(r).addClass(t).setStyle(s,n)})},this),this},l.prototype.hide=function(a){return e.Stencil.getNodeList(a).each(function(e){e.hasClass(t)&&this.transition(e,function(e){var a=e.get(i)+o;e.removeClass(n).setStyle(s,a).get(u),e.addClass(r).addClass(n).removeClass(t).setStyle(s,f)})},this),this},l.prototype.toggle=function(e){e.each(function(e){e.hasClass(t)?this.hide(e):this.show(e)},this)},e.Stencil.Hosts.Fx.plug(l)},"@VERSION@",{requires:["stencil-fx","node-style"]});
YUI.add("gallery-storage-lite",function(e,t){"use strict";var n=e.config.doc,r=e.config.win,i=e.JSON,s=e.namespace("StorageLite"),o="yui_storage_lite",u="YUI StorageLite data",a=1048576,f="1.0",l="ready",c=0,h=1,p=2,d=3,v=4,m="yui_storage_lite",g="data",y={},b,w;try{r.localStorage?w=h:r.globalStorage?w=p:r.openDatabase&&navigator.userAgent.indexOf("Chrome")===-1?w=d:e.UA.ie>=5?w=v:w=c}catch(E){w=c}e.StorageFullError=function(t){e.StorageFullError.superclass.constructor.call(t),this.name="StorageFullError",this.message=t||"Maximum storage capacity reached",e.UA.ie&&(this.description=this.message)},e.extend(e.StorageFullError,Error),e.augment(s,e.EventTarget,!0,null,{emitFacade:!0,prefix:"storage-lite",preventable:!1}),s.publish(l,{fireOnce:!0}),e.mix(s,{clear:function(){},getItem:function(e,t){return null},length:function(){return 0},removeItem:function(e){},setItem:function(e,t){}}),w===h||w===p?(e.mix(s,{length:function(){return b.length},removeItem:function(e){b.removeItem(e)},setItem:function(e,t,n){b.setItem(e,n?i.stringify(t):t)}},!0),w===h?(b=r.localStorage,e.Node.DOM_EVENTS.pageshow=1,e.on("pageshow",function(){b=r.localStorage}),e.mix(s,{clear:function(){b.clear()},getItem:function(e,t){try{return t?i.parse(b.getItem(e)):b.getItem(e)}catch(n){return null}}},!0)):w===p&&(b=r.globalStorage[r.location.hostname],e.mix(s,{clear:function(){var e;for(e in b)b.hasOwnProperty(e)&&(b.removeItem(e),delete b[e])},getItem:function(e,t){try{return t?i.parse(b[e].value):b[e].value}catch(n){return null}}},!0)),s.fire(l)):w===d||w===v?(e.mix(s,{clear:function(){y={},s._save()},getItem:function(e,t){return y.hasOwnProperty(e)?y[e]:null},length:function(){var e=0,t;for(t in y)y.hasOwnProperty(t)&&(e+=1);return e},removeItem:function(e){delete y[e],s._save()},setItem:function(e,t,n){y[e]=t,s._save()}},!0),w===d?(b=r.openDatabase(o,f,u,a),e.mix(s,{_save:function(){b.transaction(function(e){e.executeSql("REPLACE INTO "+o+" (name, value) VALUES ('data', ?)",[i.stringify(y)])})}},!0),b.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS "+o+"(name TEXT PRIMARY KEY, value TEXT NOT NULL)"),e.executeSql("SELECT value FROM "+o+" WHERE name = 'data'",[],function(e,t){if(t.rows.length)try{y=i.parse(t.rows.item(0).value)}catch(n){y={}}s.fire(l)})})):w===v&&(b=n.createElement("span"),b.addBehavior("#default#userData"),e.mix(s,{_save:function(){var t=i.stringify(y);n.body.appendChild(b);try{b.setAttribute(g,t),b.save(m)}catch(r){throw new e.StorageFullError}finally{n.body.removeChild(b)}}},!0),e.on("domready",function(){n.body.appendChild(b),b.load(m);try{y=i.parse(b.getAttribute(g)||"{}")}catch(e){y={}}finally{n.body.removeChild(b)}s.fire(l)}))):s.fire(l)},"@VERSION@",{requires:["event-base","event-custom","event-custom-complex","json","node-base"]});
/*
YUI 3.18.0 (build 790466e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("anim-base",function(e,t){var n="running",r="startTime",i="elapsedTime",s="start",o="tween",u="end",a="node",f="paused",l="reverse",c="iterationCount",h=Number,p={},d;e.Anim=function(){e.Anim.superclass.constructor.apply(this,arguments),e.Anim._instances[e.stamp(this)]=this},e.Anim.NAME="anim",e.Anim._instances={},e.Anim.RE_DEFAULT_UNIT=/^width|height|top|right|bottom|left|margin.*|padding.*|border.*$/i,e.Anim.DEFAULT_UNIT="px",e.Anim.DEFAULT_EASING=function(e,t,n,r){return n*e/r+t},e.Anim._intervalTime=20,e.Anim.behaviors={left:{get:function(e,t){return e._getOffset(t)}}},e.Anim.behaviors.top=e.Anim.behaviors.left,e.Anim.DEFAULT_SETTER=function(t,n,r,i,s,o,u,a){var f=t._node,l=f._node,c=u(s,h(r),h(i)-h(r),o);l?"style"in l&&(n in l.style||n in e.DOM.CUSTOM_STYLES)?(a=a||"",f.setStyle(n,c+a)):"attributes"in l&&n in l.attributes?f.setAttribute(n,c):n in l&&(l[n]=c):f.set?f.set(n,c):n in f&&(f[n]=c)},e.Anim.DEFAULT_GETTER=function(t,n){var r=t._node,i=r._node,s="";return i?"style"in i&&(n in i.style||n in e.DOM.CUSTOM_STYLES)?s=r.getComputedStyle(n):"attributes"in i&&n in i.attributes?s=r.getAttribute(n):n in i&&(s=i[n]):r.get?s=r.get(n):n in r&&(s=r[n]),s},e.Anim.ATTRS={node:{setter:function(t){return t&&(typeof t=="string"||t.nodeType)&&(t=e.one(t)),this._node=t,!t,t}},duration:{value:1},easing:{value:e.Anim.DEFAULT_EASING,setter:function(t){if(typeof t=="string"&&e.Easing)return e.Easing[t]}},from:{},to:{},startTime:{value:0,readOnly:!0},elapsedTime:{value:0,readOnly:!0},running:{getter:function(){return!!p[e.stamp(this)]},value:!1,readOnly:!0},iterations:{value:1},iterationCount:{value:0,readOnly:!0},direction:{value:"normal"},paused:{readOnly:!0,value:!1},reverse:{value:!1}},e.Anim.run=function(){var t=e.Anim._instances,n;for(n in t)t[n].run&&t[n].run()},e.Anim.pause=function(){for(var t in p)p[t].pause&&p[t].pause();e.Anim._stopTimer()},e.Anim.stop=function(){for(var t in p)p[t].stop&&p[t].stop();e.Anim._stopTimer()},e.Anim._startTimer=function(){d||(d=setInterval(e.Anim._runFrame,e.Anim._intervalTime))},e.Anim._stopTimer=function(){clearInterval(d),d=0},e.Anim._runFrame=function(){var t=!0,n;for(n in p)p[n]._runFrame&&(t=!1,p[n]._runFrame());t&&e.Anim._stopTimer()},e.Anim.RE_UNITS=/^(-?\d*\.?\d*){1}(em|ex|px|in|cm|mm|pt|pc|%)*$/;var v={run:function(){return this.get(f)?this._resume():this.get(n)||this._start(),this},pause:function(){return this.get(n)&&this._pause(),this},stop:function(e){return(this.get(n)||this.get(f))&&this._end(e),this},_added:!1,_start:function(){this._set(r,new Date-this.get(i)),this._actualFrames=0,this.get(f)||this._initAnimAttr(),p[e.stamp(this)]=this,e.Anim._startTimer(),this.fire(s)},_pause:function(){this._set(r,null),this._set(f,!0),delete p[e.stamp(this)],this.fire("pause")},_resume:function(){this._set(f,!1),p[e.stamp(this)]=this,this._set(r,new Date-this.get(i)),e.Anim._startTimer(),this.fire("resume")},_end:function(t){var n=this.get("duration")*1e3;t&&this._runAttrs(n,n,this.get(l)),this._set(r,null),this._set(i,0),this._set(f,!1),delete p[e.stamp(this)],this.fire(u,{elapsed:this.get(i)})},_runFrame:function(){var e=this._runtimeAttr.duration,t=new Date-this.get(r),n=this.get(l),s=t>=e;this._runAttrs(t,e,n),this._actualFrames+=1,this._set(i,t),this.fire(o),s&&this._lastFrame()},_runAttrs:function(t,n,r){var i=this._runtimeAttr,s=e.Anim.behaviors,o=i.easing,u=n,a=!1,f,l,c;t>=n&&(a=!0),r&&(t=n-t,u=0);for(c in i)i[c].to&&(f=i[c],l=c in s&&"set"in s[c]?s[c].set:e.Anim.DEFAULT_SETTER,a?l(this,c,f.from,f.to,u,n,o,f.unit):l(this,c,f.from,f.to,t,n,o,f.unit))},_lastFrame:function(){var e=this.get("iterations"),t=this.get(c);t+=1,e==="infinite"||t<e?(this.get("direction")==="alternate"&&this.set(l,!this.get(l)),this.fire("iteration")):(t=0,this._end()),this._set(r,new Date),this._set(c,t)},_initAnimAttr:function(){var t=this.get("from")||{},n=this.get("to")||{},r={duration:this.get("duration")*1e3,easing:this.get("easing")},i=e.Anim.behaviors,s=this.get(a),o,u,f;e.each(n,function(n,a){typeof n=="function"&&(n=n.call(this,s)),u=t[a],u===undefined?u=a in i&&"get"in i[a]?i[a].get(this,a):e.Anim.DEFAULT_GETTER(this,a):typeof u=="function"&&(u=u.call(this,s));var l=e.Anim.RE_UNITS.exec(u),c=e.Anim.RE_UNITS.exec(n);u=l?l[1]:u,f=c?c[1]:n,o=c?c[2]:l?l[2]:"",!o&&e.Anim.RE_DEFAULT_UNIT.test(a)&&(o=e.Anim.DEFAULT_UNIT);if(!u||!f){e.error('invalid "from" or "to" for "'+a+'"',"Anim");return}r[a]={from:e.Lang.isObject(u)?e.clone(u):u,to:f,unit:o}},this),this._runtimeAttr=r},_getOffset:function(e){var t=this._node,n=t.getComputedStyle(e),r=e==="left"?"getX":"getY",i=e==="left"?"setX":"setY",s;return n==="auto"&&(s=t.getStyle("position"),s==="absolute"||s==="fixed"?(n=t[r](),t[i](n)):n=0),n},destructor:function(){delete e.Anim._instances[e.stamp(this)]}};e.extend(e.Anim,e.Base,v)},"3.18.0",{requires:["base-base","node-style","color-base"]});
/*
YUI 3.18.0 (build 790466e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("anim-color",function(e,t){var n=Number;e.Anim.getUpdatedColorValue=function(t,r,i,s,o){return t=e.Color.re_RGB.exec(e.Color.toRGB(t)),r=e.Color.re_RGB.exec(e.Color.toRGB(r)),(!t||t.length<3||!r||r.length<3)&&e.error("invalid from or to passed to color behavior"),"rgb("+[Math.floor(o(i,n(t[1]),n(r[1])-n(t[1]),s)),Math.floor(o(i,n(t[2]),n(r[2])-n(t[2]),s)),Math.floor(o(i,n(t[3]),n(r[3])-n(t[3]),s))].join(", ")+")"},e.Anim.behaviors.color={set:function(t,n,r,i,s,o,u){t._node.setStyle(n,e.Anim.getUpdatedColorValue(r,i,s,o,u))},get:function(e,t){var n=e._node.getComputedStyle(t);return n=n==="transparent"?"rgb(255, 255, 255)":n,n}},e.each(["backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor"],function(t){e.Anim.behaviors[t]=e.Anim.behaviors.color})},"3.18.0",{requires:["anim-base"]});
/*
YUI 3.18.0 (build 790466e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("anim-xy",function(e,t){var n=Number;e.Anim.behaviors.xy={set:function(e,t,r,i,s,o,u){e._node.setXY([u(s,n(r[0]),n(i[0])-n(r[0]),o),u(s,n(r[1]),n(i[1])-n(r[1]),o)])},get:function(e){return e._node.getXY()}}},"3.18.0",{requires:["anim-base","node-screen"]});
/*
YUI 3.18.0 (build 790466e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("anim-curve",function(e,t){e.Anim.behaviors.curve={set:function(t,n,r,i,s,o,u){r=r.slice.call(r),i=i.slice.call(i);var a=u(s,0,100,o)/100;i.unshift(r),t._node.setXY(e.Anim.getBezier(i,a))},get:function(e){return e._node.getXY()}},e.Anim.getBezier=function(e,t){var n=e.length,r=[],i,s;for(i=0;i<n;++i)r[i]=[e[i][0],e[i][1]];for(s=1;s<n;++s)for(i=0;i<n-s;++i)r[i][0]=(1-t)*r[i][0]+t*r[parseInt(i+1,10)][0],r[i][1]=(1-t)*r[i][1]+t*r[parseInt(i+1,10)][1];return[r[0][0],r[0][1]]}},"3.18.0",{requires:["anim-xy"]});
/*
YUI 3.18.0 (build 790466e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("anim-easing",function(e,t){var n={easeNone:function(e,t,n,r){return n*e/r+t},easeIn:function(e,t,n,r){return n*(e/=r)*e+t},easeOut:function(e,t,n,r){return-n*(e/=r)*(e-2)+t},easeBoth:function(e,t,n,r){return(e/=r/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t},easeInStrong:function(e,t,n,r){return n*(e/=r)*e*e*e+t},easeOutStrong:function(e,t,n,r){return-n*((e=e/r-1)*e*e*e-1)+t},easeBothStrong:function(e,t,n,r){return(e/=r/2)<1?n/2*e*e*e*e+t:-n/2*((e-=2)*e*e*e-2)+t},elasticIn:function(e,t,n,r,i,s){var o;return e===0?t:(e/=r)===1?t+n:(s||(s=r*.3),!i||i<Math.abs(n)?(i=n,o=s/4):o=s/(2*Math.PI)*Math.asin(n/i),-(i*Math.pow(2,10*(e-=1))*Math.sin((e*r-o)*2*Math.PI/s))+t)},elasticOut:function(e,t,n,r,i,s){var o;return e===0?t:(e/=r)===1?t+n:(s||(s=r*.3),!i||i<Math.abs(n)?(i=n,o=s/4):o=s/(2*Math.PI)*Math.asin(n/i),i*Math.pow(2,-10*e)*Math.sin((e*r-o)*2*Math.PI/s)+n+t)},elasticBoth:function(e,t,n,r,i,s){var o;return e===0?t:(e/=r/2)===2?t+n:(s||(s=r*.3*1.5),!i||i<Math.abs(n)?(i=n,o=s/4):o=s/(2*Math.PI)*Math.asin(n/i),e<1?-0.5*i*Math.pow(2,10*(e-=1))*Math.sin((e*r-o)*2*Math.PI/s)+t:i*Math.pow(2,-10*(e-=1))*Math.sin((e*r-o)*2*Math.PI/s)*.5+n+t)},backIn:function(e,t,n,r,i){return i===undefined&&(i=1.70158),e===r&&(e-=.001),n*(e/=r)*e*((i+1)*e-i)+t},backOut:function(e,t,n,r,i){return typeof i=="undefined"&&(i=1.70158),n*((e=e/r-1)*e*((i+1)*e+i)+1)+t},backBoth:function(e,t,n,r,i){return typeof i=="undefined"&&(i=1.70158),(e/=r/2)<1?n/2*e*e*(((i*=1.525)+1)*e-i)+t:n/2*((e-=2)*e*(((i*=1.525)+1)*e+i)+2)+t},bounceIn:function(t,n,r,i){return r-e.Easing.bounceOut(i-t,0,r,i)+n},bounceOut:function(e,t,n,r){return(e/=r)<1/2.75?n*7.5625*e*e+t:e<2/2.75?n*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?n*(7.5625*(e-=2.25/2.75)*e+.9375)+t:n*(7.5625*(e-=2.625/2.75)*e+.984375)+t},bounceBoth:function(t,n,r,i){return t<i/2?e.Easing.bounceIn(t*2,0,r,i)*.5+n:e.Easing.bounceOut(t*2-i,0,r,i)*.5+r*.5+n}};e.Easing=n},"3.18.0",{requires:["anim-base"]});
/*
YUI 3.18.0 (build 790466e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("anim-node-plugin",function(e,t){var n=function(t){t=t?e.merge(t):{},t.node=t.host,n.superclass.constructor.apply(this,arguments)};n.NAME="nodefx",n.NS="fx",e.extend(n,e.Anim),e.namespace("Plugin"),e.Plugin.NodeFX=n},"3.18.0",{requires:["node-pluginhost","anim-base"]});
/*
YUI 3.18.0 (build 790466e)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("anim-scroll",function(e,t){var n=Number;e.Anim.behaviors.scroll={set:function(e,t,r,i,s,o,u){var a=e._node,f=[u(s,n(r[0]),n(i[0])-n(r[0]),o),u(s,n(r[1]),n(i[1])-n(r[1]),o)];f[0]&&a.set("scrollLeft",f[0]),f[1]&&a.set("scrollTop",f[1])},get:function(e){var t=e._node;return[t.get("scrollLeft"),t.get("scrollTop")]}}},"3.18.0",{requires:["anim-base"]});
YUI.add("stencil-gallery",function(e,t){"use strict";function k(r){this.constructor.superclass.constructor.call(this,r);if(this._node&&this._node.get("tagName").toUpperCase()==="BODY")return;var i=this._node,s,o=i.all(y),u=i.one(g),p=i.one(b),v=i.ancestor("[dir]",!0),w=u&&u.all(m),T=w&&w.size(),N;if(!i||!u||!p)return;this.node=i,this.sliderEl=u,this.maskEl=p,this.currentWidth=p.get("offsetWidth"),this.itemsEl=u&&this.sliderEl.all(m),this.indicatorsEl=o.size()>0?o:n,this.prevEl=i.one(E),this.nextEl=i.one(S),this.itemsLength=T,this.dir=r.dir,this.cacheItemsPositions(),this.dir||(this.dir=v?v.getAttribute("dir"):"ltr",this.dir=this.dir==="rtl"?-1:1),this.currentItem=r.currentItem||parseInt(i.getAttribute("data-currentItem"),10)||u&&w.indexOf(u.one("."+d)),this.currentItem<0&&(this.currentItem=0),x&&x.touch&&(s=i.getDOMNode(),N=(new Stencil.Swiper(i,{config:{swipe:{acceptable_opposite_axis_movement:300,min_swipe_distance:10}}})).captureTouch(),s.addEventListener(h,e.bind(this.swipe,this),!1),s.addEventListener(l,e.bind(this.swipe,this),!1),s.addEventListener(c,e.bind(this.swipe,this),!1),s.addEventListener(a,e.bind(this.swipe,this),!1),s.addEventListener(f,e.bind(this.swipe,this),!1),s.addEventListener("tap",function(e){},!1));if(!this.node||!this.sliderEl||!this.maskEl||!this.itemsEl.size())return;o&&this.updateIndicators(),this.updateToolbar(),i.once("mouseover",this.loadDelayedImages,this),this.resizeHandle=e.on(t+":resize",this.onResize,this)}var n=null,r=!0,i=!1,s="prev",o="next",u="jump-to",a="swipe",f="slide",l="init",c="end",h="dragstart",p=".Gallery-",d="Selected",v="Active",m=p+"Item",g=p+"Slider",y=p+"Indicator",b=p+"Mask",w="Disabled",E="button[data-jump-to=prev]",S="button[data-jump-to=next]",x=Modernizr,T=e.one("body"),N="disabled",C;e.one(e.config.win).on("resize",function(){clearTimeout(C),C=setTimeout(function(){e.fire(t+":resize")},100)},this),e.extend(k,e.Stencil.BasePlugin,{currentItem:0,itemsLength:0,itemsPositions:[],itemsWidths:[],currentWidth:0,totalWidth:0,isDelayedLoaded:i,destroy:function(){this.node=n,this.sliderEl=n,this.maskEl=n,this.itemsEl=n,this.indicatorsEl=n,this.itemsPositions=n,this.prevEl=n,this.nextEl=n,this.resizeHandle&&(this.resizeHandle.detach(),this.resizeHandle=n),this.constructor.superclass.destroy.apply(this,arguments)},loadDelayedImages:function(){T.fire("imageloader:delayed",this.node),this.isDelayedLoaded=r},cacheItemsPositions:function(){var e=[0],t=[],n=0;this.itemsEl.each(function(r,i){var s=r.get("children").item(0),o;i!==0&&e.push(e[i-1]+t[i-1]),s&&s.get("tagName").toUpperCase()==="IMG"?o=parseInt(s.get("width"),10):o=parseInt(s.get("offsetWidth"),10),t.push(o),n+=o},this),this.totalWidth=n,this.itemsWidths=t,this.itemsPositions=e},jumpTo:function(e,t){var n=this.currentWidth,r=this.currentItem,u=this.itemsLength,a=this.itemsWidths,f=this.itemsPositions,l=this.totalWidth,c=0;e=typeof e=="number"||typeof e=="string"?e:r,t=t||"slide";if(e===s){while(r!==0&&f[r-1]>l-n)r-=1;if(r!==0)do r-=1,c+=a[r];while(r!==0&&c+a[r-1]<n)}else if(e===o){if(r+1!==u)do c+=a[r],r+=1;while(r+1!==u&&c+a[r+1]<n)}else r=parseInt(e,10);r!==0&&f[r]+n>=l&&(r=u-1),this.currentItem=r,t==="slide"?this.slide(r):t==="none"&&this.translate(this.sliderEl,-this.itemsPositions[e],0,i),this.updateToolbar(),this.updateIndicators()},slide:function(e){this.translate(this.sliderEl,-this.itemsPositions[e],0)},translate:function(e,t,n,r){var s={},o=this.dir;return t=t?Math.max(t,this.currentWidth-this.totalWidth):t,t=t||t===0?o*t+"px":"",n=n||n===0?o*n+"px":"",x&&x.csstransforms3d?s.transform=t||n?"translate3d("+t+","+n+",0)":"":(s.left=t,s.top=n),r===i||!t&&!n&&!r?(e.setStyles(s),"notransition"):(s.duration=.4,e.transition(s,r),"transition")},handleEvent:function(e){var t=e.target.ancestor("[data-"+u+"]",r);t&&!t.get("disabled")&&t.getData(u)&&(this.jumpTo(t.getData(u)),e.preventDefault())},onResize:function(){var e=this.currentItem,t=this.maskEl.get("offsetWidth"),n=this.totalWidth;this.currentWidth=t,e!==0&&(n<=t?this.jumpTo(0,"none"):this.itemsPositions[e]+t>=n&&this.jumpTo(this.itemsLength-1,"none")),this.updateToolbar()},swipe:function(e){var t=0,n=this.sliderEl,r=this.itemsLength,u=this.currentItem;switch(e.type){case h:e.preventDefault();break;case l:this.loadDelayedImages();break;case f:e.detail.delta.absx>30&&(t=e.detail.delta.x+this.itemsPositions[u],this.translate(n,-t,0,i));break;case c:this.jumpTo(u);break;default:e.detail.direction==="left"?this.jumpTo(o):this.jumpTo(s)}},updateIndicators:function(){var e=this.indicatorsEl;e&&(e.removeClass(v),e.item(this.currentItem).addClass(v))},updateToolbar:function(){var e=this.currentItem,t=this.currentWidth,n=this.totalWidth,r=this.prevEl,i=this.nextEl;r&&i&&(e+1===this.itemsLength||n<=t?(i.setAttribute(N,N),i.addClass(w)):(i.removeAttribute(N,N),i.removeClass(w)),e===0||n<=t?(r.setAttribute(N,N),r.addClass(w)):(r.removeAttribute(N,N),r.removeClass(w)))}},{NS:"StencilGallery",CSS_SELECTED:d,CSS_ACTIVE:v,CSS_ITEM:m,CSS_SLIDER:g,CSS_INDICATORS:y,CSS_MASK:b,CSS_DISABLED:w,PREV_SELECTOR:E,NEXT_SELECTOR:S,requiresInit:!0}),e.Stencil.registerPlugin(k,"Gallery")},"@VERSION@",{requires:["stencil-base","yui-base","dom-base","node-base","node-style","node-pluginhost","transition"]});
YUI.add("af-locations",function(e){"use strict";e.namespace("Af").Locations=e.Mjata.ModelBase.createModelListClass("AfLocations","1.0",e.Mjata.LazyModelList,e.Mjata.Model,[e.Af.Sync],{currentLocation:null,isGeoCapable:null,readonly:!1,resource:"location",consolidate:!1,favCache:null,syncContext:{config:{uri:"/_td_api"},context:{crumb:"",helper:"ugeo"}},selectedLocation:null,EVT_FAV_LOC_ADDED:"favLocationAdded",EVT_FAV_LOC_DELETED:"favLocationDeleted",initializer:function(e){var t=this;t.favCache={},t.syncContext.config.uri=e.xhr_path||t.syncContext.config.uri,t.syncContext.context.crumb=e.user_crumb,t.geoCapable(),!e.current||!e.current.woeid?t._getLocationData("location.user.current",{},function(e,n){!e&&n&&t.setCurrent(n,!0)}):t.setCurrent(e.current,!0),e.favorite||t.getFavoriteLocations()},geoCapable:function(){var e=this;return e.isGeoCapable===null&&(e.isGeoCapable=!!window.navigator.geolocation),e.isGeoCapable},getCurrentLocation:function(e,t){var n=this,r=n.isGeoCapable||n.geoCapable();t=t||!1,r?n.getUserCurrentPosition(function(r,i){r||n.setCurrent(i,t),typeof e=="function"&&e(r,i)}):n._getLocationData("location.user.current",{},function(r,i){!r&&i&&n.setCurrent(i,t),typeof e=="function"&&e(r,i||null)})},_roundFloats:function(e,t){return Math.round(e*t)/t},getUserCurrentPosition:function(t){var n=this,r=e.Af.Utils.i18n("ape-location/strings"),i={timeout:1e4,maximumAge:0},s=function(r){n.createLocation("location.user.current",{lat:String(r.coords.latitude),lon:String(r.coords.longitude),radius:parseInt(r.coords.accuracy)},t)},o=function(n){var i={1:{code:401,message:r.BROWSER_DENIED_PERMISSION||"Browser denied permission to get your current location"},2:{code:500,message:r.BROWSER_LOCATION_NOT_FOUND||"Browser was unable to find your current location"},3:{code:408,message:r.BROWSER_TIMEOUT_LOCATION||"Browser timed out getting your location"}};t(i[n.code],null)};navigator.geolocation.getCurrentPosition(s,o,i)},getFavoriteLocations:function(t,n){t=t||{};var r=this;r._getLocationData("location.user.favorite",t,function(t,i){!t&&i&&(e.Lang.isArray(i)||(i=[i]),r.set("favorite",i)),typeof n=="function"&&n(t,i)})},createLocation:function(e,t,n){if(!e||!t)return n(null,null);var r,i=null,s=this;switch(e){case"current":case"location.user.current":i="location.user.current";break;case"favorite":case"location.user.favorite":i="location.user.favorite";break;default:return n(null,null)}t.woeid?r={resource:i,params:{woeid:t.woeid}}:r={resource:i,params:{latitude:t.lat,longitude:t.lon,radius:t.radius}},s.sync("create",r,function(e,r){!e&&r&&r.woeid&&i==="location.user.favorite"&&(t.id=s._createLocationCacheKey(r),s.appendFavoriteLocation(r,!0)),typeof n=="function"&&n(e,r)})},appendFavoriteLocation:function(e,t){if(!e)return;var n=this,r=n._createLocationCacheKey(e);n.favCache.hasOwnProperty(r)||(e.type="favorite",e.id=r,n.set("favorite",e),n.updateLocation(e,t)),n.fire(n.EVT_FAV_LOC_ADDED,{location:e})},deleteLocation:function(t,n){var r,i=this;if(!t.id){n({error:400,message:"Missing id field"},null);return}r={resource:"location.user.favorite"},t.canonical&&t.canonical==="woe"?r.params={woeid:t.woeid}:r.params={latitude:t.lat,longitude:t.lon,radius:t.radius},i.sync("delete",r,function(r,s){var o,u,a;r||(o=i.get("favorite"),u=e.Af.Utils.getObjectInArray(o,"id",t.id),a=t.id,i.favCache.hasOwnProperty(a)&&delete i.favCache[a],o.splice(u.index,1),i.set("favorite",o)),n(r,s)}),i.fire(i.EVT_FAV_LOC_DELETED,{location:t})},updateLocation:function(e,t){t=t||!1;if(!e||!e.woeid)return;this.selectedLocation=e,this.set("location",e.woeid,{silent:t}),t||this._setSelected(e,t)},search:function(e,t){if(!e||!e.hasOwnProperty("text"))return;var n=this,r=e.text,i=n.getCurrent(),s={text:r},o=e.hasOwnProperty("resource")?e.resource:"location.search";i&&i.hasOwnProperty("lat")&&i.hasOwnProperty("lon")&&(s.radius=n._roundFloats(i.lon,1e3)+","+n._roundFloats(i.lat,1e3)),e.hasOwnProperty("type")&&(s.type=e.type),n._findLocation(o,s,function(e,i){var s,o={text:r,data:null};if(!e&&i){n.set("displayState","search");if(i.length){if(!i[0]||!i[0].hasOwnProperty("woeid"))return t(null,o);s=n._mergeSearchWithFavorites(i),o.data=s}}t(e,o)})},_mergeSearchWithFavorites:function(t){var n=this,r=[],i=[],s,o,u,a,f,l;e.Lang.isArray(t)||(t=[t]),o=t.length,l=n.get("favorite");if(!l||!l.length)return t;for(s=0;s<o;s+=1)u=t[s],a=n._createLocationCacheKey(u),n.favCache.hasOwnProperty(a)?(f=n.favCache[a],f?r.push(f):(u.type="favorite",u.id=a,r.push(u))):i.push(u);return r.concat(i)},_setSelected:function(e,t){var n=this,r=this.getCurrent(),i=n.getSelectedLocation();r.woeid&&r.woeid!==e.woeid?this.createLocation("location.user.current",e,function(e,r){e||(n.setCurrent(r,!0),n.selectedLocation=r,t||n.fire("selectedLocationChange",{newVal:r,prevVal:i}))}):t||n.fire("selectedLocationChange",{newVal:e,prevVal:i})},getSelectedLocation:function(){return this.selectedLocation},setCurrent:function(e,t){if(!e)return;var n=this,r=n.getCurrent();e.qualifiedName=e.qualifiedName||e.city+", "+(e.statecode||e.state),n.currentLocation=e,n.updateLocation(e,t),t||n.fire("currentChange",{newVal:e,prevVal:r})},getCurrent:function(){return this.currentLocation},_getLocationData:function(e,t,n){this.load({resource:e,params:{}},n)},_findLocation:function(e,t,n){this.load({resource:e,params:t},n)},_createLocationCacheKey:function(e){function t(e){return e.replace(/\s/g,"_").toLowerCase()}if(!e||!e.city)return null;var n=e.city+"_";return n+=e.statecode?e.statecode:e.state,t(n)}},{ATTRS:{locdrop_crumb:{},location:{},favorite:{setter:function(t){if(!t)return null;var n,r,i,s=this.get("favorite")||[],o=[],u;e.Lang.isArray(t)||(t=[t]),r=t.length;for(n=0;n<r;n+=1)i=t[n],u=this._createLocationCacheKey(i),u&&!this.favCache.hasOwnProperty(u)&&(this.favCache[u]=i,i.type="favorite",i.id=u,o.push(i)),i.qualifiedName=i.qualifiedName||i.city+", "+(i.statecode||i.state);return o.length&&s&&s.length?t=o.concat(s):s&&s.length>0?t=s:o&&(t=o),t}}}})},"@VERSION@",{requires:["af-sync","af-utils"
,"mjata-model-base","mjata-model","mjata-lazy-modellist","mjata-model-store"]});
YUI.add("ape-location-templates-location-list",function(e,t){dust.cache=dust.cache||{},dust.cache[t]=function(){return function(){function e(e,n){return e.section(n.get("data"),n,{block:t},null).write("\n")}function t(e,t){return e.write("\n").section(t.get("locations"),t,{block:n},{i13n:t.get("i13n")}).write("\n")}function n(e,t){return e.write("\n").write('<li class="Bfc Fw-200 js-location-select" role="presentation" data-type="').reference(t.get("type"),t,"h").write('" data-woeid="').reference(t.get("woeid"),t,"h").write('" data-address="').reference(t.get("city"),t,"h").write(", ").notexists(t.get("statecode"),t,{block:r},null).exists(t.get("statecode"),t,{block:i},null).write('">').write("\n	").helper("select",t,{block:s},{key:a}).write("\n	").helper("select",t,{block:f},{key:U}).write("\n").write("</li>").write("\n")}function r(e,t){return e.reference(t.get("state"),t,"h")}function i(e,t){return e.reference(t.get("statecode"),t,"h")}function s(e,t){return e.write("\n		").helper("eq",t,{block:o},{value:"favorite"}).write("\n		").helper("default",t,{block:u},null).write("\n	")}function o(e,t){return e.write("\n		").write('<a role="button" data-ylk="sec:').reference(t.getPath(!1,["i13n","sec"]),t,"h").write(";mid:locwgt;elm:itm;slk:loc-pr;itc:1;test:").reference(t.getPath(!1,["i13n","bucket"]),t,"h").write('" data-action="click" data-action-outcome="slctloc" class="Ell Bfc C-2 Fl-start W-80 Whs-nw Td-n P-6 js-ta-item rapidnofollow" href="#">').reference(t.get("qualifiedName"),t,"h").write("</a>").write("\n		")}function u(e,t){return e.write("\n		").write('<a role="button" data-ylk="sec:').reference(t.getPath(!1,["i13n","sec"]),t,"h").write(";mid:locwgt;elm:itm;slk:loc-sug;itc:1;test:").reference(t.getPath(!1,["i13n","bucket"]),t,"h").write('" data-action="click" data-action-outcome="slctloc" class="Ell Bfc Fl-start W-80 Whs-nw Td-n P-6 js-ta-item rapidnofollow" href="#">').reference(t.get("qualifiedName"),t,"h").write("</a>").write("\n		")}function a(e,t){return e.reference(t.get("type"),t,"h")}function f(e,t){return e.write("\n		").helper("eq",t,{block:l},{value:"favorite"}).write("\n		").helper("default",t,{block:C},null).write("\n	")}function l(e,t){return e.write("\n		").write('<a role="button" href="#" data-ylk="sec:').reference(t.getPath(!1,["i13n","sec"]),t,"h").write(";mid:locwgt;elm:btn;slk:rm;itc:1;test:").reference(t.getPath(!1,["i13n","bucket"]),t,"h").write('" data-action="click" data-action-outcome="rmloc" class="D-ib Pos-a End-0 Td-n Ta-c ').exists(t.getPath(!1,["config","useplus"]),t,{"else":c,block:h},null).write(" js-user-favorite rapidnofollow favorite").exists(t.getPath(!1,["config","useplus"]),t,{block:p},null).write('" data-id="').reference(t.get("id"),t,"h").write('" data-user-action="remove" title="').section(t.getPath(!1,["i18n","REMOVE_LOCATION_TITLE"]),t,{"else":d,block:v},null).write('">').write("\n            ").exists(t.getPath(!1,["config","useplus"]),t,{"else":m,block:E},null).write("\n		").write("</a>").write("\n		")}function c(e,t){return e.write("Py-6 Px-10")}function h(e,t){return e.write("Py-2 Px-6")}function p(e,t){return e.write(" My-4 favbtn favbgc")}function d(e,t){return e.write("Remove this Location")}function v(e,t){return e.reference(t.getPath(!1,["i18n","REMOVE_LOCATION_TITLE"]),t,"h")}function m(e,t){return e.write("\n            ").exists(t.getPath(!1,["config","glyphHook"]),t,{"else":g,block:y},null).write("\n            ").write('<b class="Hidden">').section(t.getPath(!1,["i18n","REMOVE_LOCATION"]),t,{"else":b,block:w},null).write("</b></i>").write("\n            ")}function g(e,t){return e.write("\n            ").write('<i class="Fz-xs C-e Icon">&#xe023;').write("\n            ")}function y(e,t){return e.write("\n            ").write('<i class="Fz-xs C-e ').reference(t.getPath(!1,["config","glyphHook"]),t,"h",["s"]).write(' IconLocationStar">').write("\n            ")}function b(e,t){return e.write("Remove from Favorite Locations")}function w(e,t){return e.reference(t.getPath(!1,["i18n","REMOVE_LOCATION"]),t,"h")}function E(e,t){return e.write("\n            ").exists(t.getPath(!1,["config","glyphHook"]),t,{"else":S,block:x},null).write("\n            ").write('<span class="Fz-xs C-w Hidden">').section(t.getPath(!1,["i18n","SAVED"]),t,{"else":T,block:N},null).write("</span>").write("\n            ")}function S(e,t){return e.write("\n            ").write('<i class="Fz-2xs C-w Icon">&#xe063;</i>').write("\n            ")}function x(e,t){return e.write("\n            ").write('<i class="Fz-2xs C-w ').reference(t.getPath(!1,["config","glyphHook"]),t,"h",["s"]).write(' IconLocationCheck"></i>').write("\n            ")}function T(e,t){return e.write("Saved")}function N(e,t){return e.reference(t.getPath(!1,["i18n","SAVED"]),t,"h")}function C(e,t){return e.write("\n		").write('<a role="button" href="#" data-ylk="sec:').reference(t.getPath(!1,["i13n","sec"]),t,"h").write(";mid:locwgt;elm:btn;slk:add;itc:1;test:").reference(t.getPath(!1,["i13n","bucket"]),t,"h").write('" data-action="click" data-action-outcome="addloc" class="D-ib Pos-a End-0 Td-n Ta-c ').exists(t.getPath(!1,["config","useplus"]),t,{"else":k,block:L},null).write(" js-user-favorite rapidnofollow").exists(t.getPath(!1,["config","useplus"]),t,{block:A},null).write('" data-id="').reference(t.get("id"),t,"h").write('" data-user-action="add" title="').section(t.getPath(!1,["i18n","ADD_LOCATION_TITLE"]),t,{"else":O,block:M},null).write('">').write("\n            ").exists(t.getPath(!1,["config","useplus"]),t,{"else":_,block:j},null).write("\n		").write("</a>").write("\n		")}function k(e,t){return e.write("Py-6 Px-10")}function L(e,t){return e.write("Py-2 Px-4")}function A(e,t){return e.write(" My-4 favbtn")}function O(e,t){return e.write("Add this Location")}function M(e,t){return e.reference(t.getPath(!1,["i18n","ADD_LOCATION_TITLE"]),t,"h")}function _(e,t){return e.write("\n            ").exists(t.getPath(!1,["config","glyphHook"]),t,{"else":D,block:P},null).write("\n            ").write
('<b class="Hidden">').section(t.getPath(!1,["i18n","ADD_LOCATION"]),t,{"else":H,block:B},null).write("</b></i>").write("\n            ")}function D(e,t){return e.write("\n            ").write('<i class="Fz-xs C-2 Icon">&#xe061;').write("\n            ")}function P(e,t){return e.write("\n            ").write('<i class="Fz-xs C-2 ').reference(t.getPath(!1,["config","glyphHook"]),t,"h",["s"]).write(' IconLocationEmptyStar">').write("\n            ")}function H(e,t){return e.write("Add to Favorite Locations")}function B(e,t){return e.reference(t.getPath(!1,["i18n","ADD_LOCATION"]),t,"h")}function j(e,t){return e.write("\n            ").exists(t.getPath(!1,["config","glyphHook"]),t,{"else":F,block:I},null).write("\n            ").write('<span class="Fz-xs C-w Hidden">').section(t.getPath(!1,["i18n","SAVE"]),t,{"else":q,block:R},null).write("</span>").write("\n            ")}function F(e,t){return e.write("\n            ").write('<i class="Fz-xs C-w Icon">&#xe066;</i>').write("\n            ")}function I(e,t){return e.write("\n            ").write('<i class="Fz-xs C-w ').reference(t.getPath(!1,["config","glyphHook"]),t,"h",["s"]).write(' IconLocationPlus"></i>').write("\n            ")}function q(e,t){return e.write("Save")}function R(e,t){return e.reference(t.getPath(!1,["i18n","SAVE"]),t,"h")}function U(e,t){return e.reference(t.get("type"),t,"h")}return dust.register("ape-location-templates-location-list",e),e}()}(),dust.cache["ape-location:location-list.dust"]=dust.cache["ape-location:location-list"]=dust.cache[t],e.Template._cache=e.Template._cache||{},e.Template._cache["ape-location/templates/location-list"]=function(e,n){e=e||{},dust.render(t,e,n)}},"@VERSION@",{requires:["template-base","dust"]});
YUI.add("ape-location-templates-location-panel",function(e,t){dust.cache=dust.cache||{},dust.cache[t]=function(){return function(){function e(e,C){return e.write('<button title="').section(C.getPath(!1,["i18n","VIEW_LOCATION_TITLE"]),C,{"else":t,block:n},null).write('" aria-haspopup="1" class="ButtonNaked C-2 js-panel-trigger rapidnofollow" data-ylk="sec:').reference(C.getPath(!1,["i13n","sec"]),C,"h").write(";mid:locwgt;elm:inpt;slk:mu;itc:1:test:").reference(C.getPath(!1,["i13n","bucket"]),C,"h").write('" data-action="click" data-action-outcome="op">').write("\n    ").exists(C.getPath(!1,["config","glyphHook"]),C,{"else":r,block:i},null).write("\n    ").write('<b class="Hidden">').section(C.getPath(!1,["i18n","LOCATION_PICKER"]),C,{"else":s,block:o},null).write("</b>").write("\n").write("</button>").write("\n").write("<style>").write("\n    ").write(".af-locations-list li a {color: #373737;}").write("\n    ").write(".af-locations-list li a:hover,").write("\n    ").write(".af-locations-list li a:focus {").write("\n        ").write("background: #EDECEC;").write("\n        ").write("color: #373737;").write("\n        ").write("outline:none;").write("\n    ").write("}").write("\n\n    ").write(".af-locations-list li .hovertxt {").write("\n        ").write("display: none;").write("\n    ").write("}").write("\n    ").write(".af-locations-list li:hover .hovertxt {").write("\n        ").write("display: inline;").write("\n    ").write("}").write("\n    ").write(".af-locations-list li .favbtn {").write("\n        ").write("border-radius: 2px;").write("\n        ").write("background-color: #ABAEB7;").write("\n        ").write("margin-right: 4px;").write("\n    ").write("}").write("\n    ").write(".af-locations-list li .favbgc {").write("\n        ").write("background-color: #1DA09C;").write("\n    ").write("}").write("\n    ").write(".af-locations-list li .favbtn:hover,").write("\n    ").write(".af-locations-list li .favbtn:focus {").write("\n        ").write("background-color: #ABAEB7;").write("\n        ").write("color: white;").write("\n    ").write("}").write("\n    ").write(".af-locations-list li .favbgc:hover,").write("\n    ").write(".af-locations-list li .favbgc:focus {").write("\n        ").write("background-color: #1DA09C;").write("\n    ").write("}").write("\n    ").write(".animated {").write("\n        ").write("-webkit-transition: all .3s ease-out;").write("\n        ").write("-moz-transition: all .3s ease-out;").write("\n        ").write("-ms-transition: all .3s ease-out;").write("\n        ").write("-o-transition: all .3s ease-out;").write("\n        ").write("transition: all .3s ease-out;").write("\n    ").write("}").write("\n\n    ").write("/* Let's get this party started */").write("\n    ").write(".af-locations-list::-webkit-scrollbar {").write("\n        ").write("width: 6px;").write("\n    ").write("}").write("\n\n    ").write(".af-locations-list::-webkit-scrollbar-button {").write("\n        ").write("width: 0px;").write("\n        ").write("height: 0px;").write("\n    ").write("}").write("\n    ").write(".af-locations-list::-webkit-scrollbar-thumb {").write("\n        ").write("background: rgba(155,155,155,0.2);").write("\n        ").write("-webkit-border-radius: 6px;").write("\n    ").write("}").write("\n    ").write(".af-locations-list::-webkit-scrollbar-thumb:active {").write("\n        ").write("background: rgba(0,0,0,0.4);").write("\n    ").write("}").write("\n    ").write(".af-locations-list::-webkit-scrollbar-thumb:hover {").write("\n        ").write("background: rgba(90,90,90,0.3);").write("\n    ").write("}").write("\n    ").write("/* Track */").write("\n    ").write(".af-locations-list::-webkit-scrollbar-track {").write("\n        ").write("background-clip:padding-box;").write("\n        ").write("-webkit-box-shadow: inset 0 0 10px rgba(0,0,0,0.1);").write("\n        ").write("width: 5px;").write("\n    ").write("}").write("\n    ").write(".af-locations-list::-webkit-scrollbar-track:hover {").write("\n        ").write("-webkit-box-shadow: inset 0 0 10px rgba(0,0,0,0.3);").write("\n        ").write("width: 20px;").write("\n    ").write("}").write("\n    ").write(".af-locations-list::-webkit-scrollbar-track:active {").write("\n        ").write("-webkit-box-shadow: inset 0 0 10px rgba(0,0,0,0.2);").write("\n    ").write("}").write("\n\n    ").write(".af-locations-list::-webkit-scrollbar-thumb:window-inactive {").write("\n        ").write("background: transparent;").write("\n    ").write("}").write("\n").write("</style>").write("\n\n").write('<div class="js-location-panel D-n">').write("\n    ").write('<div class="Bfc Pos-r js-location-picker">').write("\n        ").write('<div class="Row Bd-b Py-8 Pos-r">').write("\n            ").write('<a href="#" title="').section(C.getPath(!1,["i18n","DETECT_YOUR_LOCATION_TITLE"]),C,{"else":u,block:a},null).write('" data-ylk="sec:').reference(C.getPath(!1,["i13n","sec"]),C,"h").write(";mid:locwgt;elm:itm;slk:dtct;itc:1;test:").reference(C.getPath(!1,["i13n","bucket"]),C,"h").write('" data-action="click" data-action-outcome="dtcloc" class="Grid-U Fw-200 Fz-s Va-m Mstart-10 rapidnofollow js-location-detect">').section(C.getPath(!1,["i18n","DETECT_MY_LOCATION"]),C,{"else":f,block:l},null).write("</a>").write("\n            ").write('<button title="').section(C.getPath(!1,["i18n","DETECT_YOUR_LOCATION_TITLE"]),C,{"else":c,block:h},null).write('" data-ylk="sec:').reference(C.getPath(!1,["i13n","sec"]),C,"h").write(";mid:locwgt;elm:itm;slk:dtct;itc:1;test:").reference(C.getPath(!1,["i13n","bucket"]),C,"h").write('" data-action="click" data-action-outcome="dtcloc" class=\'Pos-a End-0 Mend-10 Ta-c ButtonNaked js-location-detect rapidnofollow\'>').write("\n                ").exists(C.getPath(!1,["config","glyphHook"]),C,{"else":p,block:d},null).write("\n                ").write('<b class="Hidden">').section(C.getPath(!1,["i18n","DETECT_YOUR_LOCATION"]),C,{"else":v,block:m},null).write("</b>").write("\n            ").write("</button>").write
("\n        ").write("</div>").write("\n        ").write('<div class="Bfc Py-8">').write("\n            ").write('<form class="Bfc Td-n M-0 Mx-10 Bd-1 LookupBox js-location-panel-form">').write("\n            ").write('<label class="Hidden">').section(C.getPath(!1,["i18n","ENTER_CITY_ZIPCODE_LABEL"]),C,{"else":g,block:y},null).write("</label>").write("\n            ").exists(C.getPath(!1,["config","glyphHook"]),C,{"else":b,block:w},null).write("\n            ").write('<div class="LookupBoxWrap">').write("\n                ").write('<input tabindex="0" class="LookupBoxInput Lh-14 H-a O-0 location-list-ta" type="text" value="" placeholder="').section(C.getPath(!1,["i18n","ENTER_CITY_ZIPCODE_PLACEHOLDER"]),C,{"else":E,block:S},null).write('" autocomplete="off">').write("\n            ").write("</div>").write("\n            ").write('<noscript><input class="Hidden" type="submit" value="').section(C.getPath(!1,["i18n","GO"]),C,{"else":x,block:T},null).write('"></noscript>').write("\n            ").write("</form>").write("\n        ").write("</div>").write("\n        ").write('<div class="Bfc Ov-h">').write("\n            ").write('<ul class="af-locations-list Pstart-10 M-0 Mb-6 Mend-6 Bfc Divided-h Pos-r Ov-h Ovy-s animated" style="height: 0px; opacity: 0"></ul>').write("\n        ").write("</div>").write("\n        ").exists(C.get("show_manage_link"),C,{block:N},null).write("\n    ").write("</div>").write("\n").write("</div>").write("\n")}function t(e,t){return e.write("View your Locations")}function n(e,t){return e.reference(t.getPath(!1,["i18n","VIEW_LOCATION_TITLE"]),t,"h")}function r(e,t){return e.write("\n    ").write('<i class="Icon Fz-m Va-m">&#xe062;</i>').write("\n    ")}function i(e,t){return e.write("\n    ").write('<i class="').reference(t.getPath(!1,["config","glyphHook"]),t,"h",["s"]).write(' IconLocationPicker Fz-m Va-m"></i>').write("\n    ")}function s(e,t){return e.write("Location Picker")}function o(e,t){return e.reference(t.getPath(!1,["i18n","LOCATION_PICKER"]),t,"h")}function u(e,t){return e.write("Detect Your Location")}function a(e,t){return e.reference(t.getPath(!1,["i18n","DETECT_YOUR_LOCATION_TITLE"]),t,"h")}function f(e,t){return e.write("Detect my Location")}function l(e,t){return e.reference(t.getPath(!1,["i18n","DETECT_MY_LOCATION"]),t,"h")}function c(e,t){return e.write("Detect Your Location")}function h(e,t){return e.reference(t.getPath(!1,["i18n","DETECT_YOUR_LOCATION_TITLE"]),t,"h")}function p(e,t){return e.write("\n                ").write("<i class='Icon Fz-m Va-m C-2'>&#xe06f;</i>").write("\n                ")}function d(e,t){return e.write("\n                ").write("<i class='").reference(t.getPath(!1,["config","glyphHook"]),t,"h",["s"]).write(" IconLocationLocate Fz-m Va-m C-2'></i>").write("\n                ")}function v(e,t){return e.write("Detect Your Location")}function m(e,t){return e.reference(t.getPath(!1,["i18n","DETECT_YOUR_LOCATION"]),t,"h")}function g(e,t){return e.write("Enter City or Zipcode")}function y(e,t){return e.reference(t.getPath(!1,["i18n","ENTER_CITY_ZIPCODE_LABEL"]),t,"h")}function b(e,t){return e.write("\n            ").write('<b class="LookupBoxIcon Icon Fl-start">&#xe01b;</b>').write("\n            ")}function w(e,t){return e.write("\n            ").write('<b class="LookupBoxIcon ').reference(t.getPath(!1,["config","glyphHook"]),t,"h",["s"]).write(' IconLocationLookup Fl-start"></b>').write("\n            ")}function E(e,t){return e.write("Enter City or Zipcode")}function S(e,t){return e.reference(t.getPath(!1,["i18n","ENTER_CITY_ZIPCODE_PLACEHOLDER"]),t,"h")}function x(e,t){return e.write("Go")}function T(e,t){return e.reference(t.getPath(!1,["i18n","GO"]),t,"h")}function N(e,t){return e.write("\n        ").write('<div class="Row Ta-end" style="*height:1%">').write("\n            ").write('<a class="Dimmed D-b Py-4 Px-10 Bd-t" href="https://settings.yahoo.com/locations?lang=').reference(t.get("lang"),t,"h").write('" data-ylk="sec:').reference(t.getPath(!1,["i13n","sec"]),t,"h").write(";mid:locwgt;elm:itm;slk:mng;test:").reference(t.getPath(!1,["i13n","bucket"]),t,"h").write(';itc:0;tar:http://info.yahoo.com/locationmgt/" data-action="click" data-action-outcome="nav">').section(t.getPath(!1,["i18n","MANAGE_LOCATION"]),t,{"else":C,block:k},null).write("</a>").write("\n        ").write("</div>").write("\n        ")}function C(e,t){return e.write("Manage locations")}function k(e,t){return e.reference(t.getPath(!1,["i18n","MANAGE_LOCATION"]),t,"h")}return dust.register("ape-location-templates-location-panel",e),e}()}(),dust.cache["ape-location:location-panel.dust"]=dust.cache["ape-location:location-panel"]=dust.cache[t],e.Template._cache=e.Template._cache||{},e.Template._cache["ape-location/templates/location-panel"]=function(e,n){e=e||{},dust.render(t,e,n)}},"@VERSION@",{requires:["template-base","dust"]});
YUI.add("stencil-toggle",function(e){"use strict";function f(e){this.constructor.superclass.constructor.call(this,e)}var t="data-toggle-group-active",n="data-toggle-group",r="data-toggle-prevent-default",i="remove",s="toggle",o="replace",u={add:1,remove:1,toggle:1,replace:1},a;a=function(e,t,n){e.getAttribute(t)===n[0]?e.setAttribute(t,n[1]):e.setAttribute(t,n[0])},e.extend(f,e.Stencil.BasePlugin,{execute:function(e,t,n){var i=this._node,s;if(!t)return;if(n&&(i.get("tagName")==="A"&&i.getAttribute(r)!=="0"||i.getAttribute(r)==="1"))try{n.preventDefault()}catch(o){}for(s in t)t.hasOwnProperty(s)&&u[s]&&this.go(s,e,t[s])},go:function(r,i,o){var u;i||(i=e.Stencil.getNodeList(this._node)),this.processSources(i),i.each(function(i){u=null,r===s&&i.hasAttribute(n)&&(u=e.all("["+n+"="+i.getAttribute(n)+"]["+t+"]"),u.size()>0&&(u.removeAttribute(t),this.processTarget(u,r,o)));if(!u||u.indexOf(i)===-1)u&&i.setAttribute(t,1),this.processTarget(i,r,o)},this)},processTarget:function(t,n,r){var u,f,l;return e.Object.each(r,function(r,c){u=c==="classnames",typeof r=="string"&&(r=u?e.Lang.trim(r).split(","):[r]),n===o&&(u?t.setAttribute("className",""):t.setAttribute(c,""));if(c==="style")e.Object.each(r,function(r,o){var u,a,f,l;f=t.getStyle(o);for(u=0,a=r.length;u<a;u+=1){if(n===i){t.setStyle(o,"");break}if(n===s){l=e.one(document.createElement(t.get("tagName"))).setStyle(o,r[u]).getStyle(o);if(f!==l){t.setStyle(o,r[u]);break}}else t.setStyle(o,r[u])}},this);else if(u)for(f=0,l=r.length;f<l;f+=1)n===i?t.removeClass(r[f]):n===s?t.toggleClass(r[f]):t.addClass(r[f]);else n===i?t.removeAttribute(c):n===s?t instanceof e.NodeList?t.each(function(e){a(e,c,r)}):a(t,c,r):t.setAttribute(c,r[0])},this),this}},{NS:"StencilToggle",defaultTriggerEvents:["click"]}),e.Stencil.registerPlugin(f,"Toggle")},"@VERSION@",{requires:["stencil-base","yui-base","dom-base","node-base","node-style","node-pluginhost","event-focus","event-mouseenter","json-parse"]});
YUI.add("af-location-panel",function(e,t){"use strict";var n=500,r="displayState",i=!1,s="favorite",o=250,u=27,a=32,f=13,l=40,c=38,h=2,p="searchResults",d="ape-location-templates-location-list",v=null,m=!0;e.namespace("Af").LocationPanel=e.Base.create("AfLocationPanel",e.View,[],{autohide_timer:v,animation_timer:v,can_render:m,events:{".js-panel-trigger":{click:"toggle"},".Tooltip":{click:"handleClick",focus:"toggle",blur:"toggle"},".location-list-ta":{focus:function(){this.search_gui.addClass("Focused")},blur:function(){this.search_gui.removeClass("Focused")}}},i13n:{sec:"locpanl",bucket:0},input_node:v,keypress_event:v,keypress_throttle:v,list_item_height:0,list_node:v,list_template:d,list_items:v,search_gui:v,model_loaded:i,model_bootstrap:{alias:"Locations",current:v,id:"location",favorite:v,user_crumb:v},panel_node:v,panel_template:"ape-location-templates-location-panel",tooltip_conf:{id:v,position:"bfr",container:v,classes:"ThemeReset Tooltip FancyBox Arrow Bgc-w Mt-10 Lh-14 Z-5 Pos-a Cur-a",contentClasses:"TooltipContent Pos-r js-location-panel",role:"popover",width:"250px",minWidth:"150px",autohide:!1},trigger_node:v,show_manage_link:m,search_type:null,initializer:function(t){var n=this;if(!t)return i;t.show_manage_link===i&&(n.show_manage_link=i),t.list_template&&(n.list_template=t.list_template),t.panel_template&&(n.panel_template=t.panel_template);if(!t.user_crumb)return;t.i13n&&(n.i13n=e.merge(n.i13n,t.i13n)),t.hasOwnProperty("tooltip_conf")&&(n.tooltip_conf=e.merge(n.tooltip_conf,t.tooltip_conf)),t.useplus!==!1&&(t.useplus=!0),n.i18n=e.Af.Utils.i18n("ape-location/strings"),t.search_type&&typeof t.search_type=="string"&&t.search_type!==""&&(n.search_type=t.search_type),n.model_bootstrap=e.merge(n.model_bootstrap,t),n.render("location-panel",function(t,r){!t&&r&&(n.keypress_event=e.bind(n.handleKeypress,n),n.after("displayStateChange",n.resetView,n),n.search_gui=n.get("container").one(".LookupBox"))}),t.autoDetectLocation===m&&(n.lazyLoadLocationsModel(),n.getCurrentLocation(i))},activatePanel:function(){var t=this;t.lazyLoadLocationsModel();if(t.trigger_node.hasClass("active"))return;t.trigger_node.addClass("active"),t.trigger_node.removeClass("C-2"),t.trigger_node.addClass("C-e"),t.handleTypeAhead({type:"focus"}),t.tooltip_conf.id=t.panel_node.generateID(),t.resetView(),e.Stencil.Tooltip("show",t.trigger_node,t.tooltip_conf),e.later(100,t,function(){e.UA.ios&&e.UA.ios>=8&&e.UA.safari||t.input_node.focus(),t.resizeResultsList(i)},i)},resizeResultsList:function(){var t=this;if(!t.list_node)return;t.animation_timer&&t.animation_timer.cancel(),t.animation_timer=e.later(100,t,function(){var e=t.getResultsHeight();t.list_node.setStyles({height:e,opacity:1})},!1)},getResultsHeight:function(){var e=this,t=e.get("data"),n,r="0px";return!e.list_item_height&&e.list_items&&e.list_items.item&&e.list_items.item(0)&&(e.list_item_height=e.list_items.item(0).get("offsetHeight")),n=e.list_item_height,t&&(t.length===1?r=n+"px":t.length===2?r=n*2+"px":t.length>2&&(r=n*3+"px")),r},deactivatePanel:function(){var t=this;t.animation_timer&&t.animation_timer.cancel(),e.Stencil.Tooltip("hide",t.trigger_node),t.handleTypeAhead({type:"blur"}),t.trigger_node.removeClass("active"),t.trigger_node.removeClass("C-e"),t.trigger_node.addClass("C-2"),t.input_node.setContent(""),t.input_node.blur()},focusCurrentTypeaheadItem:function(e,t,n){if(!e)return;if(n==="up")t=t<0?e.item(0):e.item(t-1);else{if(t>=e)return;t=e.item(t+1)}t&&t.one("a")&&t.one("a.js-ta-item").focus()},handleClick:function(e){var t=e.target.ancestor(".js-location-select",m,"li"),n=e.target.ancestor(".js-location-detect",m,"button"),r=e.target.ancestor("a",m,"a"),i=this;if(r&&!r.hasClass("js-location-detect")){if(t){e.preventDefault();if(r.hasClass("js-user-favorite"))return i.toggleFavoriteLocation(t,r);if(r.hasClass("js-ta-item"))return i.updateSelectedLocation(t)}}else n&&(e.preventDefault(),i.getCurrentLocation(m))},handleKeypress:function(t){function y(e){d&&e!==n.input_node&&(g=d.indexOf(e.ancestor("li.js-location-select",m,"li")),g>=0&&(t.preventDefault(),n.updateSelectedLocation(d.item(g))))}function b(e){var t=e.target.ancestor("a",m,"a");t&&t.hasClass("js-ta-item")?y(t):t&&t.hasClass("remove-location")&&n.deleteLocation(t)}var n=this,r=t.keyCode,s=t.target.ancestor(".location-list-ta",m,"input"),h=r&&r===l,p=r&&r===c,d=v,g;!n.list_items&&n.list_node&&(n.list_items=n.list_node.all(".js-location-select")),d=n.list_items,n.keypress_throttle&&n.keypress_throttle.cancel();switch(t.type){case"keyup":if(r===u){n.toggle({type:"click"});return}(r===a||r===f)&&b(t),!h&&!p&&s&&(n.keypress_throttle=e.later(o,n,function(){n.handleSearch(t.target.get("value"))},i));break;case"keydown":d&&(p||h)&&(t.halt(),g=d.indexOf(t.target.ancestor("li.js-location-select")),n.focusCurrentTypeaheadItem(d,g,p===m?"up":"down"))}},handleSearch:function(t){var n=this,i=n.get(p),o={};if(typeof t!="string"||!t.length)return n.set(r,s);t=e.Lang.trim(t),t.length>h?!i||i.text!==t?(o.text=t,n.search_type&&(o.type=n.search_type),n.get("model").search(o,function(e,t){!e&&t&&n.set(p,t)})):n.set(p,i):n.set(r,s)},handleTypeAhead:function(e){switch(e.type){case"focus":this.toggleInputListener(m);break;case"blur":this.toggleInputListener(i)}},lazyLoadLocationsModel:function(){var e=this;if(e.model_loaded)return;e.model_loaded=m,e.loadModel(e.model_bootstrap,function(){(typeof e.model_bootstrap.show_favorite=="undefined"||e.model_bootstrap.show_favorite===!0)&&e.set(r,s,m)})},loadModel:function(t,n){var r=t.alias,i=e.Mjata.ModelStore.getByAlias(r),o=this;i?(o.set("model",i),t.current&&i.setCurrent(t.current,m),t.favorite&&i.set(s,t.favorite,{silent:m}),o.syncLocationData()):(i=new e.Af.Locations(t),o.set("model",i),e.Mjata.ModelStore.alias(r,i)),e.Mjata.ModelStore.after("AfLocations:favoriteChange",o.syncLocationData,o),e.Lang.isFunction(n)&&n()},resetView:function(){this.can_render&&this.render("locations-list")},toggleFavoriteLocation:function(t,n){function l(e,t){f.get("data")[
e.index].type=t,f.resetView(),n.focus(),f.autohide_timer&&f.autohide_timer.cancel()}function c(e){f.get("model").createLocation(s,e,function(e,t){!e&&t&&l(a,s)})}var o=n.getData(),u=t.getData(),a=e.Af.Utils.getObjectInArray(this.get("data"),"woeid",u.woeid),f=this;n.focus(),a&&a.data&&(o["user-action"]==="remove"?f.get(r)===s?(f.can_render=i,f.get("model").deleteLocation(a.data,function(){f.panel_node.removeClass("animated"),f.animation_timer&&f.animation_timer.cancel(),f.autohide_timer&&f.autohide_timer.cancel(),t.transition({height:"0px",opacity:0,duration:.5},function(){t.remove(),e.UA.ios&&e.UA.ios>=8&&e.UA.safari||f.input_node.focus(),f.list_items=v,f.panel_node.addClass("animated"),f.can_render=m,f.resizeResultsList()}),f.set(p,null)})):f.get("model").deleteLocation(a.data,function(){l(a,"search")}):c(a.data))},syncLocationData:function(){var e=this,t=e.get(r);t===s&&(e.set("data",e.get("model").get(s)),e.resetView(),e.resizeResultsList())},getCurrentLocation:function(t){var n=this;n.get("model").getCurrentLocation(function(r){r&&e.Af.Message.show(n.get("container").ancestor(".js-applet",m),{level:"error",token:r.message,content:r.message},v,"app"),t&&n.deactivatePanel()},i)},render:function(t,n){var r,i=this;switch(t){case"location-panel":dust.render(i.panel_template,{i13n:i.i13n,i18n:i.i18n,show_manage_link:i.show_manage_link,lang:e.config.lang||"en-US",config:i.model_bootstrap},function(e,t){i.get("container").setContent(t),i.trigger_node=i.get("container").one(".js-panel-trigger"),i.panel_node=i.get("container").one(".js-location-panel"),i.input_node=i.get("container").one(".location-list-ta"),i.theForm=i.get("container").one(".js-location-panel-form"),i.theForm.on("submit",function(e){e.preventDefault()}),i.attachEvents(),n&&typeof n=="function"&&n(null,!0)});break;case"locations-list":i.list_node=i.get("container").one(".af-locations-list"),i.list_node&&(r={locations:i.get("data"),i13n:i.i13n,i18n:i.i18n},dust.render(i.list_template,{data:r,config:i.model_bootstrap},function(e,t){e||(i.list_node.setContent(t),t.length>0&&(i.list_items=i.list_node.all(".js-location-select")))}))}return this},updateSelectedLocation:function(t){var o,u,a=this;o=t.getData(),o&&o.woeid&&(u=e.Af.Utils.getObjectInArray(a.get("data"),"woeid",o.woeid),u&&u.data&&(a.get("model").updateLocation(u.data),a.autohide_timer=e.later(n,a,function(){a.deactivatePanel(),a.set(r,s,{silent:m}),a.input_node.set("value","")},i)))},toggle:function(t){var r=this,s;if(!r.trigger_node)return;switch(t.type){case"focus":r.autohide_timer&&r.autohide_timer.cancel(),r.activatePanel();break;case"blur":r.autohide_timer=e.later(n,r,function(){r.deactivatePanel()},i);break;case"click":r.panel_node&&r.trigger_node&&(s=r.trigger_node.hasClass("active")?r.deactivatePanel:r.activatePanel,s.apply(r))}},toggleInputListener:function(e){var t=this;e?(t.panel_node.on("keyup",t.keypress_event),t.panel_node.on("keydown",t.keypress_event)):(t.panel_node.detach("keyup",t.keypress_event),t.panel_node.detach("keydown",t.keypress_event))},getFavsList:function(){var t=this,n=t.get("model"),r=e.clone(n.get(s));t.set("data",r),t.panel_node.hasClass("D-n")||t.resizeResultsList(!1)}},{ATTRS:{container:{writeOnce:i},data:{},model:{},searchResults:{setter:function(e){e&&e.data&&e.data.length&&(this.set(r,"search"),this.set("data",e.data),this.resetView(),this.resizeResultsList())}},displayState:{setter:function(e,t,n){var r=this.get("model");e!=="search"&&r&&(!n||!n.silent)&&this.getFavsList()}}}})},"@VERSION@",{langBundles:["strings"],requires:["view","mjata-model-store","af-config","af-message","af-locations","af-utils","ape-location-templates-location-list","ape-location-templates-location-panel","stencil-toggle","stencil-tooltip"]});
YUI.add("ape-location-lang-strings_en-us",function(e,t){e.Intl.add("ape-location/strings","en-US",{DETECT_YOUR_LOCATION:"Detect Your Location",DETECT_YOUR_LOCATION_TITLE:"Detect Your Location",REMOVE_LOCATION:"Remove from Favorite Locations",REMOVE_LOCATION_TITLE:"Remove this Location",ADD_LOCATION:"Add to Favorite Locations",ADD_LOCATION_TITLE:"Add this Location",SAVE:"Save",SAVED:"Saved",VIEW_LOCATION_TITLE:"View your Locations",LOCATION_PICKER:"Location Picker",DETECT_MY_LOCATION:"Detect my location",ENTER_CITY_ZIPCODE_LABEL:"Enter City or Zipcode",ENTER_CITY_ZIPCODE_PLACEHOLDER:"Enter City or Zipcode",MANAGE_LOCATION:"Manage locations",GO:"Go",FAVORATE:"favorite",BROWSER_DENIED_PERMISSION:"Browser denied permission to get your current location",BROWSER_LOCATION_NOT_FOUND:"Browser was unable to find your current location",BROWSER_TIMEOUT_LOCATION:"Browser timed out getting your location"})},"@VERSION@",{requires:["intl"]});
YUI.add("comet",function(e){function t(e){t.superclass.constructor.apply(this,arguments)}e.namespace("Comet");var n={},r="comet:ready";e.initComet=function(i,s){var o=i.replace(/https:/,"http:");return o.substr(-1)==="/"&&(o=o.substring(0,o.length-1)),n[o]||(e.publish(r),n[o]=new t,n[o].clearListeners()),s&&n[o].addListener("/meta/handshake",s),n[o].initBayeux(i,function(t){t.successful&&e.fire(r,{message:t})}),n[o]},t.NAME="Comet",t.ATTRS={uri:{value:null,setter:function(e){if(e===null)return;var t=window.location.protocol;t.indexOf("https")!==-1?e=e.replace(/http:/,"https:"):t.indexOf("http")!==-1&&(e=e.replace(/https:/,"http:"));var n=e.toLowerCase();return n.indexOf("https://")!==-1?this.set("protocol","https://"):n.indexOf("http://")!==-1&&this.set("protocol","http://"),e}},protocol:{value:"https://"},meta:{value:{handshake:{channel:"/meta/handshake",version:"1.0",supportedConnectionTypes:["long-polling"]},connect:{channel:"/meta/connect",connectionType:"long-polling"},subscribe:{channel:"/meta/subscribe"},unsubscribe:{channel:"/meta/unsubscribe"},publish:{},disconnect:{channel:"/meta/disconnect"}}},ioCfg:{value:{method:"POST",headers:{"Content-Type":"application/json",Accept:"*/*"}}},ext:{value:{all:{},handshake:{},subscribe:{"Comet-api-version":"1.1","Comet-subscriber-auth-info":null},unsubscribe:{"Comet-api-version":"1.1","Comet-subscriber-auth-info":null},connect:{},publish:{"Comet-api-version":"1.1","Comet-registration-id":"make-up","Comet-opaque-id":"markup","Comet-acknowledge-URI":"www.yahoo.com/ack","Comet-acknowledge-type":"All"},disconnect:{}}}},e.extend(t,e.Base,{_clientState:"unconnected",_advice:{},_connected:!1,_config:{backoffIncrement:1e3,maxBackoff:1e4,maxNetworkDelay:3e5,delayedSendMaxCount:10,advice:{timeout:6e4,interval:0,reconnect:"retry"},subscribe:{jsonpTimeout:5e3}},_delayedSendCount:0,_urlOrigin:"",_backoff:0,_isLongpollingConnect:!1,_isSendingQueue:!1,_clientId:null,_token:null,_lastMessageId:0,_outgoing:[],_subscribeChannel:{},_queue:new e.AsyncQueue,_ioQueue_c2s:e.io.queue,_ioQueue_s2c:e.io.queue,_jsonp:null,_listeners:{},initializer:function(t){this.setClientState("unconnected"),e.on("beforeunload",e.bind(function(){this.getClientState()!=="unconnected"&&this.disconnect()},this),window)},config:function(t,n){e.Object.setValue(this._config,t,n)},_Queue_send:function(t){var n=this;n._batch(t);if(!n.getClientId())return;if(n._isSendingQueue)return;if(n._outgoing.length<=0)return;e.each(n._outgoing,function(e){e=n._patchMessage(e)}),n._IO_send(!0,n._outgoing),n._outgoing=[]},_nextQueueSend:function(){this._Queue_send()},_IO_send:function(e,t){var n=this;if(!n.get("uri"))return;if(e){if(n._isSendingQueue||!t)return;n._IO_Queue_Send(t)}else{if(!n.getClientId())return;if(n._isLongpollingConnect||!t)return;n._IO_Longpolling_Send(t)}},_IO_Queue_Send:function(t){var n=this;n.setTokenHeader(n._token);var r=e.merge(n.get("ioCfg"),{context:n,timeout:n._config.maxNetworkDelay,data:e.JSON.stringify(t),xdr:{credentials:!0},on:{success:function(r,i){try{var s=e.JSON.parse(i.responseText);n._handleResponse(s)}catch(o){n._handleFailure(t,"json parse error");return}},failure:function(e,r){n._handleFailure(t,"500::io failed")},start:function(){n._isSendingQueue=!0},complete:function(){n._isSendingQueue=!1,n._nextQueueSend()}}});n._ioQueue_c2s.stop(),n._ioQueue_c2s(n.get("uri"),r),n._ioQueue_c2s.start()},_IO_Jsonp_Send:function(t){var n=this;if(!n.get("uri"))return;var r=n.get("uri")+"?callback={callback}",i=encodeURIComponent(e.JSON.stringify(t));r=r+"&data="+i,n._jsonp=new e.JSONPRequest(r,{on:{success:function(e){n._handleResponse(e)},timeout:function(e){n._handleFailure(t,"408:"+n._config.subscribe.jsonpTimeout+":jsonp timeout")},failure:function(){n._handleFailure(t,"500::jsonp failed")}},timeout:n._config.subscribe.jsonpTimeout}),n._jsonp.send()},_IO_Longpolling_Send:function(t){var n=this;n.setTokenHeader(n._token);var r=e.merge(n.get("ioCfg"),{context:n,timeout:n._config.maxNetworkDelay,xdr:{credentials:!0},data:e.JSON.stringify(t),on:{success:function(r,i){try{var s=e.JSON.parse(i.responseText);n._handleResponse(s)}catch(o){n._handleFailure(t,"json parse error");return}},failure:function(e,r){n._handleFailure(t,"500::io failed")},start:function(){n._isLongpollingConnect=!0},complete:function(){n._isLongpollingConnect=!1}}});n._ioQueue_s2c.stop(),n._ioQueue_s2c(n.get("uri"),r),n._ioQueue_s2c.start()},_handleResponse:function(t){if(t===undefined||t===null)return;var n=this;e.each(t,function(e){n._updateAdvice(e.advice),e.originalURI=n._urlOrigin;var t=e.channel;switch(t){case"/meta/handshake":n._handshakeResponse(e);break;case"/meta/connect":n._connectResponse(e);break;case"/meta/disconnect":n._disconnectResponse(e);break;case"/meta/subscribe":n._subscribeResponse(e);break;case"/meta/unsubscribe":n._unsubscribeResponse(e);break;default:n._messageResponse(e)}})},_updateAdvice:function(e){e&&(this._advice=this._mixin(!1,{},this._config.advice,e))},_handshakeResponse:function(e){var t=this;if(e.successful){t.setClientState("connected"),t._clientId=e.clientId,t._advice.VIP&&t.set("uri",t.get("protocol")+t._advice.VIP+"/comet"),t._notifyListeners("/meta/handshake",e),t._Queue_send();var n=t._isDisconnected()?"none":t._advice.reconnect;switch(n){case"retry":t._resetBackoff(),t._delayedConnect();break;case"handshake":t.setClientState("unconnected"),t._resetBackoff(),t._delayedHandshake();break;case"none":t._disconnect(!1)}}else t._failHandshake(e)},_failHandshake:function(e){var t=this;t.setClientState("unconnected"),t._clientId=null,t._notifyListeners("/meta/handshake",e),t._notifyListeners("/meta/unsuccessful",e);var n=t._advice.reconnect!=="none";n?(t._increaseBackoff(),t._delayedHandshake()):t._disconnect(!1)},_delayedHandshake:function(){var e=this;this._delayedSend(function(){e._handshake()})},_subscribeResponse:function(e){if(e.successful){if(!this._subscribeChannel[e.subscription]||this._subscribeChannel[e.subscription]!==!0)this._subscribeChannel[e.subscription]=!0;e.
ext["Comet-auth-token"]&&(this._token=e.ext["Comet-auth-token"]),this._notifyListeners("/meta/subscribe",e)}else this._failSubscribe(e)},_failSubscribe:function(e){this._notifyListeners("/meta/subscribe",e),this._notifyListeners("/meta/unsuccessful",e)},_connectResponse:function(e){var t=this;if(t._isDisconnected())return;t._connected=e.successful;if(t._connected){t.setClientState("connected"),t._notifyListeners("/meta/connect",e);var n=t._isDisconnected()?"none":t._advice.reconnect;switch(n){case"retry":t._resetBackoff(),t._delayedConnect();break;case"handshake":t.setClientState("unconnected"),t._resetBackoff(),t._delayedHandshake();break;case"none":t._disconnect(!1)}}else t._failConnect(e)},_failConnect:function(e){var t=this;t._notifyListeners("/meta/connect",e),t._notifyListeners("/meta/unsuccessful",e);var n=t._isDisconnected()?"none":t._advice.reconnect;switch(n){case"retry":t._delayedConnect(),t._increaseBackoff();break;case"subscribe":t._delayedConnect(),t._increaseBackoff();break;case"handshake":t.setClientState("unconnected"),t._resetBackoff(),t._delayedHandshake();break;case"none":t._disconnect(!1)}},_delayedConnect:function(){var e=this;this._delayedSend(function(){e._connect()})},_disconnectResponse:function(e){e.successful?(this._disconnect(!1),this._notifyListeners("/meta/disconnect",e)):this._failDisconnect(e)},_failDisconnect:function(e){this._disconnect(!0),this._notifyListeners("/meta/disconnect",e),this._notifyListeners("/meta/unsuccessful",e)},_unsubscribeResponse:function(e){e.successful?(this._subscribeChannel[e.subscription]&&this._subscribeChannel[e.subscription]===!0&&delete this._subscribeChannel[e.subscription],this._notifyListeners("/meta/unsubscribe",e)):this._failUnsubscribe(e)},_failUnsubscribe:function(e){this._notifyListeners("/meta/unsubscribe",e),this._notifyListeners("/meta/unsuccessful",e)},_messageResponse:function(e){e.successful===undefined?e.data?this._notifyListeners(e.channel,e):this._notifyListeners("/meta/unsuccessful",e):e.successful?this._notifyListeners("/meta/publish",e):this._failMessage(e)},_failMessage:function(e){this._notifyListeners("/meta/publish",e),this._notifyListeners("/meta/unsuccessful",e)},_delayedSend:function(e){var t=this,n=t._advice.interval+t._backoff;t._config.maxBackoff<=t._backoff?t._delayedSendCount++:t._delayedSendCount=0;if(t._delayedSendCount>t._config.delayedSendMaxCount){var r=t.get("uri");t.set("uri",t._urlOrigin);if(r===t.get("uri"))return;t._resetBackoff(),t._delayedSendCount=0}t._queue.add({fn:e,timeout:n}),t._queue.run()},_handshakeFailure:function(e,t){this._failHandshake({successful:!1,failure:!0,channel:"/meta/handshake",request:e,advice:{reconnect:"retry",interval:this._backoff},error:t||"",ext:e.ext||{},id:e.id||""})},_connectFailure:function(e,t){this._connected=!1,this._failConnect({successful:!1,failure:!0,channel:"/meta/connect",request:e,advice:{reconnect:"retry",interval:this._backoff},clientId:e.clientId||"",error:t||"",ext:e.ext||{},id:e.id||""})},_disconnectFailure:function(e,t){this._failDisconnect({successful:!1,failure:!0,channel:"/meta/disconnect",request:e,advice:{reconnect:"none",interval:0},clientId:e.clientId||"",error:t||"",ext:e.ext||{},id:e.id||""})},_subscribeFailure:function(e,t){this._failSubscribe({successful:!1,failure:!0,channel:"/meta/subscribe",request:e,advice:{reconnect:"none",interval:0},clientId:e.clientId||"",subscription:e.subscription||"",error:t||"",ext:e.ext||{},id:e.id||""})},_unsubscribeFailure:function(e,t){this._failUnsubscribe({successful:!1,failure:!0,channel:"/meta/unsubscribe",request:e,advice:{reconnect:"none",interval:0},clientId:e.clientId||"",subscription:e.subscription||"",error:t||"",ext:e.ext||{},id:e.id||""})},_messageFailure:function(e,t){this._failMessage({successful:!1,failure:!0,channel:e.channel,request:e,advice:{reconnect:"none",interval:0},clientId:e.clientId||"",subscription:e.subscription||"",error:t||"",ext:e.ext||{},id:e.id||""})},_handleFailure:function(e,t){var n,r,i;for(i=0;i<e.length;++i){n=e[i],r=n.channel;switch(r){case"/meta/handshake":this._handshakeFailure(n,t);break;case"/meta/connect":this._connectFailure(n,t);break;case"/meta/disconnect":this._disconnectFailure(n,t);break;case"/meta/subscribe":this._subscribeFailure(n,t);break;case"/meta/unsubscribe":this._unsubscribeFailure(n,t);break;default:this._messageFailure(n,t)}}},_notifyListeners:function(e,t){this._notify(e,t),this._notify(e+"/*",t);var n=e.split("/"),r=n.length-1,i=0;for(i=r;i>0;--i){var s=n.slice(0,i).join("/")+"/*";i===r&&this._notify(s,t),this._notify(s,t)}},_notify:function(t,n){var r=this._listeners[t];r&&e.each(r,function(t){e.Lang.isFunction(t.listener)&&t.listener(n)})},_isDisconnected:function(){return this._clientState==="unconnected"},_resetBackoff:function(){this._backoff=0},_nextMessageId:function(){return++this._lastMessageId+""},_increaseBackoff:function(){this._backoff<this._config.maxBackoff&&(this._backoff+=this._config.backoffIncrement)},_createMessage:function(t,n){n=n||{};var r=(new Date).valueOf(),i=window.location.host,s=[],o=e.merge(this.get("ext").all,this.get("ext")[t],n.ext||{},{timestamp:r,host:i||""});switch(t){case"handshake":s.push(e.merge({id:this._nextMessageId(),ext:o},this.get("meta")[t]));break;case"connect":s.push(e.merge({id:this._nextMessageId(),ext:o},this.get("meta")[t],{clientId:this.getClientId()}));break;case"subscribe":s.push(e.merge({id:this._nextMessageId(),ext:o},this.get("meta")[t],{clientId:this.getClientId(),subscription:n.channel}));break;case"unsubscribe":s.push(e.merge({id:this._nextMessageId(),ext:o},this.get("meta")[t],{clientId:this.getClientId(),subscription:n.channel}));break;case"publish":s.push(e.merge({id:this._nextMessageId(),ext:o},this.get("meta")[t],{clientId:this.getClientId(),channel:n.channel,data:n.data}));break;case"disconnect":s.push(e.merge({id:this._nextMessageId(),ext:o},this.get("meta")[t],{clientId:this.getClientId()}))}return s},_handshake:function(e){var t=this;if(t.getClientState()!=="unconnected"
){if(t.getClientState()==="connected"){var n={successful:!0,channel:"/meta/handshake",clientId:t._clientId,originalURI:t._urlOrigin};t._notifyListeners("/meta/handshake",n)}return}e&&e.listener&&t._addListener(e,!1),t._clientId=null,t._token=null,t.resetTokenHeader(),t._clearSubscriptions(),t._updateAdvice(t._config.advice);var r=t._createMessage("handshake",e);t._IO_send(!0,r),t.setClientState("connecting")},_connect:function(e){var t=this;if(t.getClientState()!=="connected")return;if(t._isLongpollingConnect)return;var n=t._createMessage("connect",e);t._IO_send(!1,n)},_subscribeJSONP:function(e){if(!e||!e.channel)return;if(!this.getClientId())return;if(this._subscribeChannel[e.channel]&&this._subscribeChannel[e.channel]===!0)return;e.listener&&this._addListener(e,!0);var t=this._createMessage("subscribe",e);this._IO_Jsonp_Send(t)},_unsubscribe:function(e){if(!this.getClientId())return;e&&e.channel&&this.removeListeners(e.channel);if(e&&e.channel){var t=this._createMessage("unsubscribe",e);this._Queue_send(t)}},_disconnect:function(e){var t=this;e&&(t._ioQueue_c2s.stop(),t._ioQueue_s2c.stop()),t.setClientState("unconnected"),t._clientId=null,t._resetBackoff(),t._queue.stop();if(t._outgoing.length>0){var n=t._outgoing;t._outgoing=[],t._handleFailure(n,"500::canceled after disconnect")}t._clearSubscriptions()},_patchMessage:function(e){return e.id||(e.id=this._nextMessageId()),e.clientId=this.getClientId(),e.channel==="/meta/handshake"&&delete e.clientId,e},_batch:function(){e.each(arguments,function(t){if(t&&e.Lang.isArray(t)){var n=0;for(n=0;n<t.length;++n)this._outgoing.push(t[n])}else t&&this._outgoing.push(t)},this)},_clearSubscriptions:function(){e.each(this._listeners,function(t){t&&e.each(t,function(e,t,n){e&&e.isSub&&n.splice(t)})}),this._subscribeChannel={}},_reDoSubscriptions:function(){e.each(this._subscribeChannel,function(e,t){e&&(this._subscribeChannel[t]=!1,this._subscribeJSONP({channel:t}))},this)},isDuplicatedListener:function(e,t){var n=0;for(n=0;n<t.length;++n){var r=t[n];if(r&&r.listener&&r.listener.toString()===e.toString())return!0}return!1},_addListener:function(t,n,r){t&&t.listener&&e.Lang.isFunction(t.listener)&&(this._listeners[t.channel]?(r||!this.isDuplicatedListener(t.listener,this._listeners[t.channel]))&&this._listeners[t.channel].push({listener:t.listener,isSub:n}):this._listeners[t.channel]=[{listener:t.listener,isSub:n}])},_mixin:function(e,t,n){var r,i,s=t||{};for(r=2;r<arguments.length;++r){var o=arguments[r];if(o===undefined||o===null)continue;for(i in o){var u=o[i],a=s[i];if(u===t)continue;if(u===undefined)continue;e&&typeof u=="object"&&u!==null?u instanceof Array?s[i]=this._mixin(e,a instanceof Array?a:[],u):s[i]=this._mixin(e,{},u):s[i]=u}}return s},destructor:function(){},getClientState:function(){return this._clientState},setClientState:function(e){this._clientState=e},getClientId:function(){return this._clientId},initBayeux:function(e,t){this._urlOrigin=e,this.set("uri",e),this._handshake({channel:"/meta/handshake",listener:t})},subscribe:function(e,t){this._subscribeJSONP({channel:e,listener:t})},unsubscribe:function(e){this._unsubscribe({channel:e})},disconnect:function(e){var t=this;e&&t._addListener({channel:"/meta/disconnect",listener:e},!1);if(t.getClientState()==="unconnected")return;if(!t.getClientId())return;var n=t._createMessage("disconnect");t._Queue_send(n)},publishMsg:function(e,t){if(e&&t){var n={channel:e,data:t},r=this._createMessage("publish",n);this._Queue_send(r)}},clearListeners:function(){this._listeners={}},addListener:function(t,n,r){r=r||!1;if(!n&&e.Lang.isFunction(n))return;this._addListener({channel:t,listener:n},!1,r)},removeListeners:function(e){this._listeners[e]&&delete this._listeners[e]},setUserInfo:function(e,t){if(e&&t){var n=this.get("ext");n.subscribe["Comet-subscriber-auth-info"]={uid:e,user_type:"yahoo",user_cred:t}}},setUserInfoWithCookie:function(e,t){if(e){var n=this.get("ext");n.subscribe["Comet-subscriber-auth-info"]={uid:e,user_type:"yahoo",user_cred:"Any Value"}}},setTokenHeader:function(e){if(e){var t=this.get("ioCfg");t.headers.Authorization="Basic token="+e}},resetTokenHeader:function(){var e=this.get("ioCfg");e.headers.Authorization="Basic token="},setYcaHeader:function(e,t){if(e){var n=this.get("ioCfg");n.headers["Yahoo-App-Auth"]=e}if(t){var r=this.get("ext");r.publish["Comet-opaque-id"]=t}}}),e.Comet=t},"@VERSION@",{requires:["base","io","json","async-queue","cookie","jsonp","jsonp-url"]});
YUI.add("af-comet",function(e,t){"use strict";function j(e){var t,n=e.length,r=0;for(t=0;t<n;t++)r+=e[t];return Math.round(r/n)}function F(e){var t=Math.floor(e.length/2);return e.length%2?e[t]:Math.round((e[t-1]+e[t])/2)}function I(e){var r,i,s=a?a.trackLatency:u.trackLatency;if(!s||l||!c)return;e=parseInt(e,10);if(typeof e!="number")return;f.push(e),i=parseInt(a&&a.latencySampleSize,10)||u.latencySampleSize,f.length>=i&&(l=!0,f.sort(function(e,t){return e-t}),r=F(f),c.perf(t,{code:"onepushLatency",time:r,clientId:n[M]&&n[M].getClientId(),sampleSize:f.length,min:f[0],max:f[f.length-1],median:r,mean:j(f)}),f=[])}function q(e){return a.publicCometHost===a.privateCometHost?M:e.indexOf("*")>0?O:M}function R(t,n,i){var s=r[t],o=e.merge({clientId:s.clientId},i);p.each(s.proxies,function(t){t.fire(n,o)})}function U(e,t){var n=r[t];n.tries=n.tries?n.tries+1:1,n.tries<=a.subscribeMaxTries&&e.subscribe(t)}function z(e){p.each(r,function(r,i){q(i)===e&&(r.state=k,r.tries=0,r.clientId="",U(n[e],i))})}function W(e){var t,s,o,u=[];for(t=0,s=i.length;t<s;t++)o=i[t],q(o)===e?(r[o].state=k,U(n[e],o)):u.push(o);i=u}function X(e){var i=n[e],s={};i.addListener(N,function(r){r.successful&&(s[e]?c&&c.info(t,{code:"rehandshake",type:e},y):s[e]=!0,z(e),W(e))}),i.addListener(x,function(t){var n=t.subscription,s=r[n],o;if(!t.successful){s&&(s.state=A),o=E.test(t.error)||S.test(t.error);if(!o||s.tries>=a.subscribeMaxTries){s.tries=0,R(n,B,{code:"subscribe",message:t.error||"",clientId:t.clientId});return}U(i,n);return}s||(s=r[n]={state:C,proxies:{}}),s.state=L,s.clientId=t.clientId,R(n,D,{clientId:t.clientId,tries:s.tries}),i.addListener(n,function(t){var r=d.find(t),i;i=r&&r.parseFn(t),i&&R(n,H,{clientId:t.clientId,messages:i})})}),i.addListener(T,function(t){var n=t.subscription,i=r[n];i&&(i.tries=0);if(!t.successful){R(n,B,{code:"unsubscribe",message:t.error||"",clientId:t.clientId});return}i&&(i.state=A,R(n,P,{clientId:t.clientId}),delete r[n])})}function V(r){if(n[r])return;if(a.shutdown){c&&h.urlParseBoolean(a.trackShutdown)&&c.info(t,{code:"shutdown"},y);return}if(!v(e.initComet)){c&&c.error(t,{},{code:"nocomet"},y);return}var i=n[r]=e.initComet(a[r+"CometHost"]);i.config(["subscribe","jsonpTimeout"],a.subscribeTimeout),X(r),i.getClientState()===_&&W(r),c&&h.urlParseBoolean(a.trackInitComet)&&c.info(t,{code:r+"Comet"},y)}function $(t){var s=r[t],o=q(t),u=n[o];u&&s.state!==L&&s.state!==k&&(u.getClientState()===_?(s.state=k,U(u,t)):e.Array.indexOf(i,t)<0&&i.push(t))}function J(e){this.id=++s,this.channel=e}var n={},r={},i=[],s=0,o="http://comet.yahoo.com/comet",u={publicCometHost:o,privateCometHost:o,shutdown:!1,subscribeMaxTries:1,subscribeTimeout:5e3,trackInitComet:!1,trackShutdown:!1,trackLatency:!0,latencySampleSize:50},a,f=[],l=!1,c=e.Af.Beacon,h=e.Af.Utils,p=e.Object,d,v=e.Lang.isFunction,m=e.Lang.isString,g=function(e){return e instanceof RegExp},y={once:!0},b=/^\d+$/,w=/^(\d+)\-(\d+)\-(\d+) (\d+):(\d+):(\d+)$/,E=/^408:\d+:jsonp timeout$/,S=/^500::jsonp failed$/,x="/meta/subscribe",T="/meta/unsubscribe",N="/meta/handshake",C=null,k="opening",L="open",A="closed",O="private",M="public",_="connected",D="open",P="close",H="message",B="error";(function(){function n(e){var t=window.location.protocol;return e&&(t.indexOf("https")===0?e=e.replace(/http:/,"https:"):e=e.replace(/https:/,"http:")),e}var r=e.Af.Config,i=r.get("context")||{},s=i.onepush_publicCometHost,o=i.onepush_privateCometHost;a=e.merge(u,r.get("onepush"),r.get("comet")),s&&(a.publicCometHost=s),o&&(a.privateCometHost=o),a.publicCometHost=n(a.publicCometHost),a.privateCometHost=n(a.privateCometHost)})(),d={parsers:[],parseLastUpdated:function(e){if(!e)return C;var t,n;return b.test(e)?(t=parseInt(e,10),n="D"+t,n.length<14&&(t*=1e3),t):(t=e.match(w),t?(t=Array.prototype.slice.call(t),t.shift(),t[1]=parseInt(t[1],10)-1,(new Date(t[0],t[1],t[2],t[3],t[4],t[5])).getTime()):C)},add:function(e,t){return e&&m(e)&&(e=new RegExp(e)),g(e)&&v(t)?(this.parsers.unshift({regex:e,parseFn:t}),!0):!1},find:function(e){var t,n,r=this.parsers.length;if(e)for(n=0;n<r;n++){t=this.parsers[n];if(t.regex&&t.regex.test(e.channel))return t}return C},addDefaults:function(){this.add(/^\/[\/\.\w\d]+$/,function(n){return!n||!n.data?C:e.Lang.isArray(n.data)?n:[n]}),this.add(/^\/\w*\/?sports\/games\/[\w\d\.]+$/,function(n){var r,i;try{r=e.JSON.parse(n.data)}catch(s){return C}return!r||n.channel!==r.chn?C:(i=[],e.Array.each(r.updates,function(t){var n=d.parseLastUpdated(t.lastUpdatedTs),r=d.parseLastUpdated(t.lastUpdated),s=(new Date).getTime(),o={};t.update&&t.update.length&&(e.Array.each(t.update,function(e){e._op==="up"&&h.objectSetValue(o,e.key,e.value)}),i.push({data:o,seq:t.seq,time:t.time,lastUpdated:r,lastUpdatedTs:n}));try{n?I(s-n):r&&I(s-r)}catch(u){}}),i)})}},d.addDefaults(),J.prototype={close:function(){var e=this,t=e.channel,i=r[t];e.fire(P),e.detachAll(),i&&(delete i.proxies[e.id],p.size(i.proxies)===0&&(i.state===L||i.state===k)&&n[q(t)].unsubscribe(t))}},e.augment(J,e.EventTarget,!0,C,{emitFacade:!0}),e.namespace("Af").CometChannelProxy=J,e.namespace("Af").Comet={addParser:function(e,t){return d.add(e,t)},open:function(e){if(!e)return C;var t;V(q(e)),r[e]=r[e]||{state:C,proxies:{}},t=new J(e),r[e].proxies[t.id]=t;switch(r[e].state){case L:window.setTimeout(function(){t.fire(D,{clientId:r[e].clientId})},0);break;case k:break;default:$(e)}return t},parseLastUpdated:d.parseLastUpdated}},"@VERSION@",{requires:["af-beacon","af-config","comet","event-custom-base","json-parse"]});
YUI.add("af-pipe",function(e,t){"use strict";function k(){this._items=[]}function L(){this._item=null}function A(r){var i=this;i._host=r.host,i._cfg=e.merge(p,n.get("pipe")),e.stamp(i),i._channel=r.pipe&&r.pipe.channel||i._host&&(i._host.pipeChannel||i._host.get("pipeChannel")),i._dataAdapterFn=r.pipe&&r.pipe.dataAdapterFn||i._host&&(i._host.pipeDataAdapterFn||i._host.get("pipeDataAdapterFn")),i._meta={channel:i._channel},i._publishEvents(),e.Af.Beacon&&i.on([T,x],function(n){e.Af.Beacon.error(t,i._meta,e.merge({code:n.type},n.pipe))})}var n=e.Af.Config,r=e.Lang,i=e.Array,s=e.Af.Utils,o=n.isFeatureOn("pipedebug"),u=r.isFunction,a=r.isNumber,f=r.isObject,l=r.isValue,c="lastUpdated",h="noseq",p={msg_maxidle:3e5,msg_throttle:2e3,seq_algo:c},d={},v="host-missing-seq",m="invalid-seq",g="open-failed",y="close-failed",b="ts-outoforder",w=null,E=!0,S="close",x="error",T="idle",N="open",C="message";d[h]=k,k.prototype={empty:function(){return!this._items.length},pop:function(e,t){var n=this._items;return this._items=[],t&&t(w,n)},push:function(e,t){return this._items.push(e),t&&t(w)}},d[c]=L,L.prototype={empty:function(){return!this._item},pop:function(e,t){var n=this,r=n._item;return!r||!e?t&&t(w,w):(n._item=w,e.lastUpdatedTs&&r.lastUpdatedTs&&r.lastUpdatedTs>=e.lastUpdatedTs?t&&t(w,[r]):e.lastUpdated&&r.lastUpdated&&r.lastUpdated>=e.lastUpdated?t&&t(w,[r]):t&&t(w,w))},push:function(e,t){var n,r,i=this;return e?i._item?(e.lastUpdatedTs&&i._item.lastUpdatedTs?(n=i._item.lastUpdatedTs,r=e.lastUpdatedTs):e.lastUpdated&&i._item.lastUpdated&&(n=i._item.lastUpdated,r=e.lastUpdated),r?n>r?t&&t({code:b,message:n+">"+r}):(n===r?i._item=e:n<r&&(i._item=s.objectMerge(i._item,e)),t&&t(w)):t&&t({code:m,message:"invalid msg. algo=lastUpdated"})):(i._item=e,t&&t(w)):t&&t(w)}},A.addMessageParser=function(t,n){e.Af.Comet.addParser(t,n)},A.NS="pipe",A.prototype={open:function(t){t=e.merge({delay:0},t);var n=Math.max(0,t.delay-3e4),r=e.Lang.now(),i,s=this;n>0?(i=r+n,s._delayTimer&&i<s._delayTimer.when&&(s._delayTimer.cancel(),s._delayTimer=w),s._delayTimer||(s._delayTimer=e.later(n,s,s._open,[t]),s._delayTimer.when=i)):s._open(t)},close:function(){var e=this;e._delayTimer&&(e._delayTimer.cancel(),e._delayTimer=w),e._idleTimer&&(e._idleTimer.cancel(),e._idleTimer=w),e._io&&(e._io.close(),e._io=w)},config:function(t){this._cfg=e.merge(p,n.get("pipe"),t)},destroy:function(){this.close()},_getSeqId:function(){var t=this,n=t._host,r,i=e.Af.Comet.parseLastUpdated;if(t._cfg.seq_algo===c){r={lastUpdatedTs:i(t.lastUpdatedTs||n&&(n.lastUpdatedTs||n.get("lastUpdatedTs"))),lastUpdated:i(t.lastUpdated||n&&(n.lastUpdated||n.get("lastUpdated")))};if(a(r.lastUpdatedTs)||a(r.lastUpdated))return r}return w},_setIdleTimer:function(){var t=this;t._idleTimer&&t._idleTimer.cancel(),t._idleTimer=e.later(t._cfg.msg_maxidle,w,function(){t._fireEvent(T,{idleTime:t._cfg.msg_maxidle})})},_open:function(){var t=this,n=t._cfg.seq_algo;if(n!==h&&t._getSeqId()===w){t._fireEvent(x,{code:v,message:"algo="+n});return}t._delayTimer&&(t._delayTimer.cancel(),t._delayTimer=w),t._io||(t._io=e.Af.Comet.open(t._channel),t._io.on("open",function(n){t._meta.clientId=n.clientId,t._fireEvent(N)}),t._io.on("close",function(){t._msgQ=w,t._fireEvent(S)}),t._io.on("message",t._onMessage,t),t._io.on("error",t._onError,t))},_onError:function(e){e.code==="subscribe"?this._fireEvent(x,{code:g,message:e.message,clientId:e.clientId}):e.code==="unsubscribe"&&this._fireEvent(x,{code:y,message:e.message,clientId:e.clientId})},_onMessage:function(e){var t=this,n;t._msgQ||(n=d[t._cfg.seq_algo]||d[h],t._msgQ=new n),t.throttled_pop=t.throttled_pop||s.throttle(function(){if(!t._msgQ||t._msgQ.empty())return;t._msgQ.pop(t._getSeqId(),function(e,n){if(e)return;if(!n||!n.length)return;var r={},o,u;i.each(n,function(e){r=s.objectMerge(r,e.data),o=e.lastUpdatedTs,u=e.lastUpdated}),l(o)&&(r.lastUpdatedTs=o),l(u)&&(r.lastUpdated=u),t._fireEvent(C,{data:r})})},t._cfg.msg_throttle),i.each(e.messages,function(n){if(!n)return;t._setIdleTimer(),t._msgQ&&t._msgQ.push({lastUpdatedTs:n.lastUpdatedTs,lastUpdated:n.lastUpdated,data:n.data},function(e){e?t._fireEvent(x,e):t.throttled_pop()})})},_fireEvent:function(e,t){this.fire(e,{pipe:t||{}}),o&&console&&console.log&&console.log("pipe event:",this._meta,e,t||"")},_publishEvents:function(){var e=this;e.publish(S,{emitFacade:E}),e.publish(x,{defaultFn:e._defaultErrFn,emitFacade:E}),e.publish(T,{defaultFn:e._defaultIdleFn,emitFacade:E}),e.publish(N,{emitFacade:E}),e.publish(C,{defaultFn:e._defaultMessageFn,emitFacade:E})},_defaultErrFn:function(e){},_defaultIdleFn:function(){this.close()},_defaultMessageFn:function(t){var n=this,r={},i=n._host,o=n._dataAdapterFn,a=t.pipe.data;if(!a)return;i&&u(i.setAttrs)?(e.Object.each(a,function(e,t){var n=i.get(t);f(n)?r[t]=s.objectMerge(n,e):r[t]=e}),o&&(r=o(r,i)),i.setAttrs(r)):i||(a.lastUpdatedTs&&(n.lastUpdatedTs=a.lastUpdatedTs),a.lastUpdated&&(n.lastUpdated=a.lastUpdated))}},e.augment(A,e.EventTarget,E,null,{emitFacade:E}),e.namespace("Af").Pipe=A},"@VERSION@",{requires:["af-beacon","af-comet","af-config","af-utils","event-custom-base"]});
